var nx={VERSION:"2.0.0",global:function(){return this}.call(null),SILENT:!1,OPTIMIZED:!1,TEXTUAL:function(){try{return"function A(){}"===eval("(function A(){})").toString()}catch(e){return!1}}()},global=nx.global;nx.idle=function(){},nx.identity=function(a){return a},nx.bool=function(a){return!!a},nx.uuid=function(){var a,b=function(b){var c=12;if(b&&a){var c,d=a.length-1;for(c=0;12>c&&(a[d-c]++,!(a[d-c]<16));c++)a[d-c]=0}return 12>c?(c=0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){return a[c++].toString(16)}).toUpperCase()):(a=[],"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var c=16*Math.random()|0,d="x"==b?c:3&c|8;return a.push(d),d.toString(16)}).toUpperCase())};return b.serial=function(){return b(!0)},b}(),nx.clone=function(){var a=function(){var a,b,c,d,e;return a=function(a,b){for(var c=0;c<a.length;c++)if(a[c].key===b)return a[c].value;return null},b=function(a,b,c){var d;for(d=0;d<a.length;d++)if(a[d].key===b)return void(a[d].value=c);a[d]={key:b,value:c}},c=function(a){return 0===a.length?null:a[a.length-1]},d=function(a){var b=[];if("[object Array]"==Object.prototype.toString.call(a))for(var c=0;c<a.length;c++)b.push(c);else for(var d in a)b.push(d);return b},e=function(e){if(window===e||document===e)return null;if(["null","undefined","number","string","boolean","function"].indexOf(typeof e)>=0)return e;if(!nx.is(e,"Array")&&!nx.is(e,"PlainObject"))return e;var f,g,h,i=[],j=[],k=e,l=nx.is(e,"Array")?[]:{};for(b(i,k,l),j.push({origin:k,dest:l,keys:d(k),idx:0});;){if(f=c(j),!f)break;if(k=f.origin,l=f.dest,f.keys.length<=f.idx)j.pop();else{if(g=f.keys[f.idx++],nx.is(k[g],"Array"))l[g]=[];else{if(!nx.is(k[g],"PlainObject")){l[g]=k[g];continue}l[g]={}}h=a(i,k[g]),h?l[g]=h:(b(i,k[g],l[g]),j.push({origin:k[g],dest:l[g],keys:d(k[g]),idx:0}))}}return l}}();return function(b,c){if(b){if(b.__clone__)return b.__clone__(c);if(c)return a(b);if(nx.is(b,"Array"))return b.slice(0);var d={};for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);return d}return b}}(),nx.extend=function(a){for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a},function(a){var b=Object.prototype.hasOwnProperty,c=Object.prototype.toString;a.is=function(d,e){if(d&&d.__is__)return d.__is__(e);switch(e){case void 0:case"Undefined":return void 0===d;case null:case"Null":return null===d;case Object:case"Object":return d&&"object"==typeof d;case String:case"String":return"string"==typeof d;case Boolean:case"Boolean":return"boolean"==typeof d;case"NaN":return isNaN(d);case Number:case"Number":return"number"==typeof d;case"Function":return typeof d===e.toLowerCase();case Array:case"Array":return d&&d.constructor===Array;case"Arguments":return"[object Arguments]"===c.call(d);case"PlainObject":var f;if(!d||"[object Object]"!==c.call(d)||d.nodeType||d===window)return!1;try{if(d.constructor&&!b.call(d,"constructor")&&!b.call(d.constructor.prototype,"isPrototypeOf"))return!1}catch(g){return!1}for(f in d);return void 0===f||b.call(d,f);default:if("number"==typeof e&&"number"==typeof d&&isNaN(e)&&isNaN(d))return!0;if("string"==typeof e&&(e=a.path(e)),d&&e)if("function"==typeof e){if(d instanceof e)return!0}else if(e.prototype)return d instanceof e}return!1}}(nx),nx.each=function(a,b,c){var d=!1;if(a&&b)if(a.__class__&&a.__each__)d=!1===a.__each__(b,c);else if(nx.is(a,"Array")||"[object Arguments]"===Object.prototype.toString.call(a)||nx.global.NodeList&&a instanceof NodeList||nx.global.HTMLCollection&&a instanceof HTMLCollection){for(var e=0,f=a.length;f>e;e++)if(b.call(c,a[e],e)===!1){d=!0;break}}else for(var g in a)if(a.hasOwnProperty(g)&&b.call(c,a[g],g)===!1){d=!0;break}return!d},nx.path=function(a,b,c){var d=arguments.length<3,e=a;if(b){var f,g,h,i=0;if("string"==typeof b)f=b.split(".");else{if(!nx.is(b,"Array"))return a;f=b}if(h=f.length,d)for(;e&&h>i;i++)g=f[i],e=e.__get__?e.__get__(g):e[g];else{for(h-=1;e&&h>i;i++)g=f[i],e=e.__get__?e.__get__(g):e[g]=e[g]||{};g=f[i],e&&(e.__set__?e.__set__(g,c):e[g]=c,e=c)}}return e},Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a,arguments)}}),function(a){var b=(a.global,Array.prototype.slice);a.func={apply:function(c,d){var e=arguments.length,f=arguments[e-1];return a.is(f,"Array")||(f=f&&f.length>=0?b.call(f):[]),e>3&&(f=b.call(arguments,2,e-1).concat(f)),c.apply(d,f)}}}(nx),nx.array={times:function(a,b){for(var c=[];a--;)c.push(b);return c},find:function(a,b,c){if(a.find)return a.find(b,c);var d,e;for(d=0;d<a.length;d++)if(e=a[d],b.call(c,e,d,a))return e},findLast:function(a){var b,c;for(b=a.length-1;b>=0;b--)if(c=a[b],matcher.call(context,c,b,a))return c},findIndex:function(a,b,c){if(a.findIndex)return a.findIndex(b,c);var d,e;for(d=0;d<a.length;d++)if(e=a[d],b.call(c,e,d,a))return d;return-1},findLastIndex:function(a,b,c){var d,e;for(d=a.length-1;d>=0;d--)if(e=a[d],b.call(c,e,d,a))return d;return-1},query:function(){var a,b={publics:{select:function(a,b){var c=[];if($.isArray(a)&&$.isFunction(b)){var d,e;for(d=0;d<a.length;d++)e=a[d],b(e)&&c.push(e)}return c},group:function(a,b){var c;if($.isFunction(b)){c={};var d,e,f;for(d=0;d<a.length;d++)e=b(a[d]),e&&"string"==typeof e&&(f=c[e]=c[e]||[],f.push(a[d]))}else c=a;return c},aggregate:function(a,b){var c,d=null;if($.isFunction(b))if($.isArray(a))d=b(a);else{d=[];for(c in a)d.push(b(a[c],c))}return d}},privates:{aggregate:function(a,c){var d,e=null,f=null;return $.isArray(c)?("function"==typeof c[c.length-1]&&(f=c.pop()),e=c.length>1?c:c[0]):(e=c.map,f=c.aggregate),"string"==typeof e&&(e=e.replace(/\s/g,"").split(",")),$.isArray(e)&&e[0]&&"string"==typeof e[0]&&(e=function(a){return function(b){var c,d={};for(c=0;c<a.length;c++)d[a[c]]=b[a[c]];return JSON.stringify(d)}}(e)),d=b.publics.aggregate(b.publics.group(a,e),f)},mapping:function(a,b){var c,d;if("string"==typeof b&&(b=function(a){return function(b){return nx.path(b,a)}}(b)),b===!0)d=EXPORT.clone(a);else if($.isFunction(b))if($.isArray(a))for(d=[],c=0;c<a.length;c++)d.push(b(a[c],c));else d=b(a,0);else d=$.isArray(a)?a.slice():a;return d},orderby:function(a,b){return"string"==typeof b&&(b=b.replace(/^\s*(.*)$/,"$1").replace(/\s*$/,"").replace(/\s*,\s*/g,",").split(",")),$.isArray(b)&&b[0]&&"string"==typeof b[0]&&(b=function(a){return function(b,c){var d,e,f;if(!b&&!c)return 0;for(d=0;d<a.length;d++){if(e=a[d],f=/\sdesc$/.test(e),e=e.replace(/(\s+desc|\s+asc)$/,""),b[e]>c[e])return f?-1:1;if(c[e]>b[e])return f?1:-1}return 0}}(b)),b&&"function"==typeof b&&a.sort(b),a}},query:function(a,c){return 1==arguments.length&&(c=a,a=c.array),a?(c.select&&(a=b.publics.select(a,c.select)),c.aggregate&&(a=b.privates.aggregate(a,c.aggregate)),c.mapping&&(a=b.privates.mapping(a,c.mapping)),c.orderby&&(a=b.privates.orderby(a,c.orderby)),a):a}};for(a in b.publics)b.query[a]=b.publics[a];return b.query}(),count:function(a,b){var c,d=a.length,e=0;for(c=0;d>c;c++)a[c]===b&&e++;return e},mapping:function(a,b,c){var d,e=[];for(d=0;d<a.length;d++)e[d]=b.call(c,a[d]);return e},cross:function(a,b,c){var d,e;d=function(a,b){var c,d,e=a.length,f=b.length;for(c=0,d=0;e>c;c++)for(d=0;f>d;d++)if(a[c]===b[d])return{i0:c,i1:d,value:a[c]};return null},e=function(a,b){var f=d(a,b),g=d(b,a),h=[[]];switch(f&&(h=EXPORT.mapcar(function(a){a.unshift(f.value)},e(a.slice(f.i0+1),b.slice(f.i1+1))),f.i0!==g.i1&&(h=h.concat(EXPORT.mapcar(function(a){a.unshift(g.value)},e(b.slice(g.i0+1),a.slice(g.i1+1)))))),c){case"max":h=[nx.array.query({array:h,orderby:"length desc"})[0]];break;case"min":h=[nx.array.query({array:h,orderby:"length"})[0]]}return h};var f=e(a,b);return"max"==c||"min"==c?f[0]:f},diff:function(a,b){var c,d,e,f,g,h,i,j=[];for(c=nx.array.cross(al,ar,"max"),d=e=0,g=h=i=ar.length,d=0,e=0,f=0,g=al.length,h=c.length,i=ar.length;g>d||h>e||i>f;d++,e++,f++){for(;g>d&&al[d]!==c[e];)j.push({action:"remove",position:f}),d++;for(;i>f&&c[e]!==ar[f];)j.push({action:"add",position:f,object:ar[f]}),f++}return j}},nx.date=function(){var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],d=function(a){return("00"+a).slice(-2)},e={yyyy:function(a){return a.getFullYear()},yy:function(a){return a.getFullYear().toString().slice(-2)},MMMM:function(a){return b[a.getMonth()]},MMM:function(a){return c[a.getMonth()]},MM:function(a){return d(a.getMonth()+1)},M:function(a){return a.getMonth()+1},dd:function(a){return d(a.getDate())},d:function(a){return a.getDate()},hh:function(a){var b=a.getHours();return 12===b?"12":d(b%12)},h:function(a){var b=a.getHours();return 12===b?"12":b%12},P:function(a){return a.getHours()<12?"AM":"PM"},HH:function(a){return d(a.getHours())},H:function(a){return a.getHours()},mm:function(a){return d(a.getMinutes())},m:function(a){return a.getMinutes()},ss:function(a){return d(a.getSeconds())},s:function(a){return a.getSeconds()},DDDD:function(b){return a[b.getDay()]},DDD:function(b){return a[b.getDay()].substring(0,3)},D:function(a){return a.getDay()}};return{now:Date.now,format:function(a,b){var c=a||"yyyy-MM-dd hh:mm:ss DD",d=b||new Date;return c.replace(/yyyy|yy|MMMM|MMM|MM|dd|d|hh|h|P|HH|H|mm|m|ss|s|DDDD|DDD|D/g,function(a){return e[a](d)})}}}(),function(a){function b(a){return function(b){var c=a(b);return EXPORT.approximate(c,0)?0:c}}a.math={approximate:function(a,b,c){c=c||1e-10;var d=a-b;return c>d&&d>-c},square:function(a){return a*a},sin:b(Math.sin),cos:b(Math.cos),tan:b(Math.tan),cot:function(a){var b=Math.tan(a);return b>1e10||-1e10>b?0:1/b},zero:function(){return 0},one:function(){return 1},negative:function(a){return-(a||0)},and:function(){var a,b=!!arguments[0];for(a=1;a<arguments.length;a++)b=b&&arguments[a];return b},or:function(){var a,b=!!arguments[0];for(a=1;a<arguments.length;a++)b=b||arguments[a];return b},not:function(a){return!a},square:function(a){if(arguments.length>1){var b,c=0;for(b=0;b<arguments.length;b++)c+=arguments[b]*arguments[b]}return a*a||0},plus:function(){var a=arguments[0]||0;for(i=1;i<arguments.length;i++)a+=arguments[i];return a},plusone:function(a){return a+1},multiply:function(){var a=arguments[0]||1;for(i=1;i<arguments.length;i++)a*=arguments[i];return a},divide:function(a,b){return a/b},minus:function(a,b){return a-b},sign:Math.sign||function(a){return 0>a?-1:a>0?1:0}}}(nx),function(a){var b=/^\s+|\s+$/g;a.string={trim:function(a){return a.trim?a.trim():a.replace(b,"")},camelize:function(a){return a.replace(/-\w/g,function(a){return a.charAt(1).toUpperCase()})},uncamelize:function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}}}(nx),function(a){a.sets=function(b,c){for(var d in c)a.path(b,d,c[d])}}(nx),function(a){a.timer=function(a,b){var c={timeout:null,resources:[],again:function(d){c.timeout=setTimeout(function(){clearTimeout(c.timeout),c.timeout=null;var a=b(c.again);a&&c.resources.push(a)},d>=0?d:a)}};return c.again(a),{release:function(){c.timeout&&clearTimeout(c.timeout);for(var a;c.resources.length;)a=c.resources.pop(),a&&"function"==typeof a.release&&a.release()}}}}(nx),nx.serial=function(){var a=1;return function(){return a++}}(),function(a){a.binding=function(b,c,d){return this instanceof a.binding?void(arguments.length&&("function"==typeof b?(d=b,c=!1,b=[]):"boolean"==typeof b?(d=c,c=b,b=[]):"function"==typeof c?(d=c,c=!1):"string"==typeof b||a.is(b,"Array")||(d=b.handler,c=b.async,b=b.paths||[]),"string"==typeof b&&(b=b.replace(/\s/g,"").split(",")),this.paths=b,this.async=c,this.handler=d)):new a.binding(b,c,d)}}(nx),function(a){function b(){this.__id__=a.serial(),this.__listeners__={},this.__watchers__={},this.__resources__={},this.__properties__=a.extend({},this.__properties__),this.__methods__=a.extend({},this.__methods__),this.self=this}var c=a.global,d=Object.prototype.hasOwnProperty,e=Array.prototype.slice,f=function(a,b,c){c=c||{};var d,e,f=a.__mixins__||[];for(d=0;d<f.length;d++){if(e=f[d],c[e.__id__]||(c[e.__id__]=!0),e===b||e.prototype instanceof b)return!0;if(isMixin(e,b,c))return!0}},g={constructor:b,__nx__:!0,__class__:b,__namespace__:"nx.Object",__properties__:{},__methods__:{},__mixins__:[],__initializers__:[],global:c,inherited:function(c){var d,e,f=a.is(c,"Arguments")?c:arguments,g=this.inherited.caller,h=g.__super__;return"init"!==g.__name__?h&&h.apply(this,f):(d=h?h.__class__:h=b,this.__type_initialized__[d.__id__]||(this.__type_initialized__[d.__id__]=!0,h.apply(this,f)),e=g.__class__,a.each(e.__mixins__,function(a){this.__type_initialized__[a.__id__]||(this.__type_initialized__[a.__id__]=!0,a.__ctor__.call(this))},this),a.each(e.__initializers__,function(a){a.initialize.call(this)},this),void 0)},retain:function(b,c){var d=arguments.length;if(0===d)return!this.__released__;if(2>d)return"string"==typeof b?this.__resources__[b]:this.retain(a.serial(),b);if(this.__resources__[b]){if(this.__resources__[b]===c)return c;this.__resources__[b].release()}for(;"function"==typeof c;)c=c.call(this);return c&&"function"==typeof c.release?(this.__resources__[b]=c,c):void delete this.__resources__[b]},release:function(b){void 0===b?(this.__released__=!0,a.each(this.__resources__,function(a){a&&a.release()}),this.__resources__={}):this.__resources__[b]&&(this.__resources__[b].release(),delete this.__resources__[b])},on:function(b,c,e){var f=this.__listeners__,g=f[b]=f[b]||{size:0},h=a.serial(),i={owner:this,handler:c,context:e||this};return g[h]=i,g.size++,1===g.size&&i.owner.fire("+"+b),{id:h,release:function(){d.call(g,h)&&(delete g[h],g.size--,g.size||i.owner.fire("-"+b))}}},fire:function(a){var b,c,d=e.call(arguments,1),f=this.__listeners__[a];for(b in f)if(c=f[b],c&&c.handler&&(result=c.handler.apply(c.context,[c.owner].concat(d)),result===!1))return!1},watch:function(b,c,d){if("function"==typeof c){var e=this.__watchers__,f=e[b]=e[b]||{size:0},g=this,h=a.serial(),i=(this[b],f[h]={id:h,owner:this,name:b,handler:c,affect:function(a){i.resource&&i.resource.release();var e,f=g.__get__(b);e=c.call(d||g,b,f,a,g),e&&"function"==typeof e.release&&(i.resource=e)}});return f.size++,i.affect(),{release:function(){i.resource&&i.resource.release(),delete f[h],--f.size||delete e[b]}}}},notify:function(a,b){var c,d=this.__watchers__[a];for(c in d)"size"!==c&&d[c].affect(b)},__is__:function(b){return"string"==typeof b&&(b=a.path(c,b)),"function"==typeof b&&b.__nx__?this instanceof b?!0:f(this.__class__,b)?!0:!1:!1},__has__:function(a){var b=this[a];return b&&"property"==b.__type__},__get__:function(a){var b=this[a];return b&&"property"==b.__type__?b.call(this):b},__set__:function(a,c){var e=this[a];if(e||d.call(this,a)||(b.extendProperty(this,a,{}),e=this[a]),"function"==typeof e&&"property"==e.__type__)return e.call(this,c);throw new Error("Unable to set property: "+a)}};a.extend(b,{prototype:g,__meta__:{},__nx__:!0,__id__:a.serial(),__namespace__:g.__namespace__,__methods__:g.__methods__,__properties__:g.__properties__,__ctor_idle__:!0,__mixins__:[],__initializers__:[],IDLE_RESOURCE:{release:a.idle},extendProperty:function(c,e,f,g){(a.is(f,a.binding)||!a.is(f,"Object"))&&(f={value:f});var h,i,j,k;i="_"+e,j=f.value instanceof a.binding?f.value:!f.dependencies&&!f.async||d.call(f,"value")&&"function"!=typeof f.value?f.value:a.binding({paths:a.is(f.dependencies,"String")?f.dependencies.replace(/\s/g,"").split(","):f.dependencies,async:f.async,handler:"function"==typeof f.value&&f.value});var l=function(){return function(a,b){if(void 0===a&&0===arguments.length)return h.__getter__?h.__getter__.call(this):this[i];var c=h.__getter__?h.__getter__.call(this):this[i];return(h.__equal__?h.__equal__(c,a):c!==a)&&(h.__setter__?h.__setter__.call(this,a,b)!==!1&&this.__watchers__[e]&&this.notify(e,c):(this[i]=a,this.__watchers__[e]&&this.notify(e,c))),a}};if("function"!=typeof c[e])h=l(),a.extend(h,{__type__:"property",__name__:e,__meta__:a.extend({},f),__binding__:j,__getter__:f.get,__setter__:f.set,__equal__:"function"==typeof f.equalityCheck&&f.equalityCheck,__watchers__:"function"==typeof f.watcher?[f.watcher]:[]}),c[e]=h;else{if(d.call(c,e)?h=c[e]:(h=l(),a.extend(h,{__type__:"property",__name__:e,__meta__:a.extend({},f),__binding__:c[e].__binding__,__get__:c[e].__get__,__set__:c[e].__set__,__equal__:c[e].__equal__,__watchers__:c[e].__watchers__.slice()}),c[e]=h),"property"!==h.__type__)return;(j||d.call(f,"value")&&f.value===j)&&(h.__binding__=j),f.get&&(f.get.__super__=h.__getter__,h.__getter__=f.get),f.set&&(f.set.__super__=h.__setter__,h.__setter__=f.set),"function"==typeof f.equalityCheck&&(h.__equal__=f.equalityCheck),"function"==typeof f.watcher&&h.__watchers__.push(f.watcher)}return c.__properties__[e]=h.__meta__,k={initialize:function(){var c,g,h=this[e];g="function"==typeof h.__binding__?h.__binding__.call(this):h.__binding__,g instanceof a.binding?(c=b.affectBinding(this,e,g),this.retain(c)):d.call(f,"value")&&h.call(this,g);for(var i,j=h.__watchers__.length,i=0;j>i;i++)this.retain(this.watch(e,h.__watchers__[i]))}},g&&k.initialize.call(c),k},extendMethod:function(a,b,c){a[b]&&"method"==a[b].__type__;a[b]&&a[b]!==c&&(c.__super__=a[b]),c.__name__=b,c.__type__="method",c.__meta__={},a[b]=c,a.__methods__[b]=c},binding:function(c,d,f,g){if(!d)return b.IDLE_RESOURCE;var h,i=new b;return h=a.extend({},g,{set:function(d,e){return i.release("recursive"),d instanceof a.binding?void i.retain("recursive",b.binding(c,d,f,g)):f.call(c,d,e)}}),d.paths&&d.paths.length?d.async&&d.handler?i.retain(b.cascade(c,d.paths,function(){var a=e.call(arguments);a.unshift(h),i.retain("async",d.handler.apply(c,a))})):i.retain(b.cascade(c,d.paths,function(a){h.set(d.handler?d.handler.apply(c,arguments):a)})):d.async&&d.handler?i.retain("async",d.handler.call(c,h)):h.set(d.handler?d.handler.call(c):a.path(c,d.paths[0])),i},affectBinding:function(a,c,d){var e=a[c];return e?b.binding(a,d,e,{get:e.bind(a)}):b.IDLE_RESOURCE},watch:function(b,c,d,e){var f="string"==typeof c?c.replace(/\s/g,"").split("."):c,g=function(f,h,i){return f?i.length?a.is(f,a.Object)?f.watch(i[0],function(a,b,c){return g(b,c,i.slice(1))}):g(a.path(f,i[0]),a.path(h,i[0]),i.slice(1)):d.call(e||b,c,f,h):d.call(e||b,c,f,a.path(h,i))};return g(b,void 0,f)},cascade:function(c,d,e,f){if(c&&d&&e){var g,h,i=new a.Object;g="string"==typeof d?d.replace(/\s/g,"").split(","):d,h=[];var j=function(a,b){var d=h.slice();a&&d.push(a,b),e.apply(f||c,d)};return a.each(g,function(b,d){h[d]=a.path(c,b)}),a.each(g,function(a,d){i.retain(b.watch(c,g[d],function(a,b){var c=h[d];c!==b&&(h[d]=b,j(g[d],c))}))}),j(null,null),i}}}),a.Object=b}(nx),function(nx){function define(pathname,parent,meta){var Class,classname;if(meta?parent||(parent=nx.Object):parent?"string"!=typeof pathname?(meta=parent,parent=pathname,pathname=null):(meta=parent,parent=nx.Object):(meta=pathname||{},parent=nx.Object,pathname=null),meta&&meta["static"])return meta=nx.extend({},meta),delete meta["static"],singleton(pathname,parent,meta);Class=function(a){if(!this instanceof arguments.callee)return nx.factory(arguments.callee,arguments);if(!(a instanceof nx.idle)){var b=arguments[0];"[object Arguments]"!==Object.prototype.toString.call(b)&&(b=arguments),this.__initializing__=!0,this.__type_initialized__={},this.__ctor__.apply(this,b),delete this.__type_initialized__,this.__initializing__=!1}},nx.TEXTUAL&&(classname=pathname?pathname.split(".").pop():"Anonymous",nx.define.cutpoint=nx.define.cutpoint||function(){}.toString().indexOf("("),Class=eval(["(function ",classname,Class.toString().substring(nx.define.cutpoint),")"].join("")));var prototype,mixins,initializers,init,init_meta,init_super;return mixins=parent.__ctor_idle__?parent.__mixins__.slice():[],mixins=nx.is(meta.mixins,"Array")?mixins.concat(meta.mixins):mixins.concat("function"==typeof meta.mixins?[meta.mixins]:[]),initializers=parent.__ctor_idle__?parent.__initializers__.slice():[],init_super=parent.__ctor__&&parent.__ctor_idle__?parent.__ctor__.__super__:parent.__ctor__,init_meta=init=meta.methods&&meta.methods.init,init||(init=function(){this.inherited(arguments)}),nx.extend(init,{__type__:"method",__name__:"init",__class__:Class,__super__:init_super}),prototype=function(){var a=function(){};return a.prototype=parent.prototype,new a}(),nx.extend(prototype,{constructor:Class,__nx__:!0,__class__:Class,__super__:parent,__ctor__:init,__properties__:nx.extend({},prototype.__properties__),__methods__:nx.extend({},prototype.__methods__),__mixins__:prototype.__mixins__.slice()}),nx.extend(Class,meta.statics),nx.extend(Class,{prototype:prototype,__nx__:!0,__id__:nx.serial(),__meta__:meta,__super__:prototype.__super__,__ctor__:init,__ctor_idle__:!init_meta,__mixins__:mixins,__initializers__:initializers}),apply_meta(Class,meta),pathname&&(Class.__namespace__=pathname,prototype.__namespace__=pathname,nx.path(nx.global,pathname,Class)),Class}function singleton(a,b,c){a&&"string"!=typeof a&&(c=b,b=a,a=null),"function"!=typeof b&&(c=b,b=nx.Object);var d=define(b,c),e=new d;return a&&nx.path(nx.global,a,e),e}var global=nx.global,apply_meta=function(a,b){var c=b.mixins;nx.is(c,"Array")||(c="function"==typeof c?[c]:[]);var d=a.prototype;nx.each(c,function(b){-1===d.__mixins__.indexOf(b)&&(d.__mixins__.push(b),apply_meta(a,b.__meta__))}),nx.each(b.methods,function(a,b){"init"!==b&&nx.Object.extendMethod(d,b,a)}),nx.each(b.properties,function(b,c){var e=nx.Object.extendProperty(d,c,b);a.__initializers__.push(e)})};nx.define=define,nx.singleton=singleton}(nx),function(a){var b=Object.prototype.toString,c=Object.prototype.hasOwnProperty,d=a.define("nx.Map",{methods:{init:function(b){if(this.inherited(),this._nummap={},this._strmap={},this._nxomap={},this._objmap=[],a.is(b,d))b.each(function(a,b){this.set(b,a)},this);else{var c;for(c in b)this.set(c,b[c])}},clear:function(){delete this._undefined,delete this._null,delete this._true,delete this._false,this._nummap={},this._strmap={},this._nxomap=[],this._objmap=[],this.fire("change",{action:"clear"})},has:function(a){if(null===a)return c.call(this,"_null");if(void 0===a)return c.call(this,"_undefined");switch(b.call(a)){case"[object Null]":return c.call(this,"_null");case"[object Boolean]":return c.call(this,a?"_true":"_false");case"[object Undefined]":return c.call(this,"_undefined");case"[object Number]":return c.call(this._nummap,a);case"[object String]":return c.call(this._strmap,a);default:return a.__id__?c.call(this._nxomap,a.__id__):!!d.getArrayMapItem(this._objmap,a)}},remove:function(a){var c=this.get(a);if(null===a)delete this._null;else if(void 0===a)delete this._undefined;else switch(b.call(a)){case"[object Null]":delete this._null;case"[object Undefined]":return this._undefined;case"[object Boolean]":a?delete this._true:delete this._false;case"[object Number]":delete this._nummap[a];case"[object String]":delete this._strmap[a];default:a.__id__?delete this._nxomap[a.__id__]:d.removeArrayMapItem(this._objmap,a)}return this.fire("change",{action:"remove",key:a,previousValue:c}),c},get:function(a){if(null===a)return this._null;if(void 0===a)return this._undefined;switch(b.call(a)){case"[object Null]":return this._null;case"[object Boolean]":return a?this._true:this._false;case"[object Undefined]":return this._undefined;case"[object Number]":return this._nummap[a];case"[object String]":return this._strmap[a];default:return a.__id__?(this._nxomap[a.__id__]||{}).value:d.getArrayMapValue(this._objmap,a)}},set:function(a,c){var e=this.get(a);if(e===c)return c;if(null===a)this._null=c;else if(void 0===a)this._undefined=c;else switch(b.call(a)){case"[object Null]":this._null=c;break;case"[object Boolean]":a?this._true=c:this._false=c;break;case"[object Undefined]":this._undefined=c;break;case"[object Number]":this._nummap[a]=c;break;case"[object String]":this._strmap[a]=c;break;default:a.__id__?this._nxomap[a.__id__]={key:a,value:c}:d.setArrayMapValue(this._objmap,a,c)}return this.fire("change",{action:"set",key:a,previousValue:e,value:c}),c},each:function(a,b){if(c.call(this,"_undefined")&&a.call(b,this._undefined,void 0)===!1)return!1;if(c.call(this,"_null")&&a.call(b,this._null,null)===!1)return!1;if(c.call(this,"_true")&&a.call(b,this._true,!0)===!1)return!1;if(c.call(this,"_false")&&a.call(b,this._false,!1)===!1)return!1;var d,e,f;for(d in this._nummap)if(a.call(b,this._nummap[d],Number(d))===!1)return!1;for(d in this._strmap)if(a.call(b,this._strmap[d],d)===!1)return!1;for(d in this._nxomap)if(e=this._nxomap[d],a.call(b,e.value,e.key)===!1)return!1;for(d=0,f=this._objmap.length;f>d;d++)if(e=this._objmap[d],a.call(b,e.value,e.key)===!1)return!1},monitor:function(b,c){var d=this,e=new a.Map,f=d.on("change",function(a,d){var f;switch(d.action){case"set":f=e.get(d.key),f&&f.release(),f=b.call(c,d.key,d.value,d.previousValue),f&&e.set(d.key,{release:f});break;case"remove":f=e.get(d.key),f&&f.release();break;case"clear":e.each(function(a,b){a&&a.release()}),e.clear()}});return d.each(function(a,d){var f=b.call(c,d,a);f&&e.set(d,f)}),{release:function(){f&&(e.each(function(a,b){a&&a.release()}),e.clear(),f.release(),f=null)}}},cascade:function(b,c,d){"string"==typeof b&&(b=b.replace(/\s/g,"").split(","));var e;e=[],a.each(b,function(a){e.push(this.get(a))},this);var f=this.on("change",function(a,f){var g,h;switch(f.action){case"set":case"remove":g=b.indexOf(f.key),g>=0&&e[g]!==f.value&&(e[g]=f.value,h=e.slice(),h.push(f.key,f.previousValue),c.apply(d,h));break;case"clear":c.call(d)}});return c.apply(d,e),{release:function(){f&&(f.release(),f=null)}}},__each__:function(a,b){return this.each(a,b)},__get__:function(a){return this[a]&&"property"===this[a].__type__?this[a].call(this):this.get(a)},__set__:function(a,b){return this[a]&&"property"===this[a].__type__?this[a].call(this,b):this.set(a,b)}},statics:{getArrayMapItem:function(a,b){return a.filter(function(a){return a.key===b})[0]},removeArrayMapItem:function(b,c){a.each(b,function(a,d){return a.key===c?(b.splice(d,1),!1):void 0})},getArrayMapValue:function(a,b){return(d.getArrayMapItem(a,b)||{}).value},setArrayMapValue:function(a,b,c){var e=d.getArrayMapItem(a,b);return e?e.value=c:a.push({key:b,value:c}),c}}})}(nx),function(a){a.define("nx.Counter",a.Map,{methods:{init:function(){this.inherited(arguments),this.on("change",function(a,b){var c=b.previousValue||0,d=b.value||0,e={item:b.key,previousCount:c,count:d};d>c&&this.fire("increase",e),c>d&&this.fire("decrease",e),this.fire("count",e)})},get:function(a){return this.inherited(a)||0},increase:function(a,b){b=arguments.length>1?Math.floor(1*b||0):1;var c=this.get(a)+b;return c?this.set(a,this.get(a)+b):(this.remove(a),0)},decrease:function(a,b){b=arguments.length>1?Math.floor(1*b||0):1;var c=this.get(a)-b;return c?this.set(a,c):(this.remove(a),0)}}})}(nx),function(a){var b=(a.global,Array.prototype.splice),c=Array.prototype.slice,d=(Object.prototype.hasOwnProperty,Math.sign||a.math.sign,/^(&&|\|\||&|\||\^|-|\(|\)|[a-zA-Z\_][a-zA-Z\d\_]*|\s)*$/),e=/&&|\|\||&|\||\^|-|\(|\)|[a-zA-Z\_][a-zA-Z\d\_]*/g,f=/[a-zA-Z\_][a-zA-Z\d\_]*/,g=/&&|\|\||&|\||\^|-|\(|\)/,h={"-":"complement","&":"cross","^":"delta","|":"union","&&":"and","||":"or"},i=a.define("nx.List",{properties:{length:{set:function(){throw new Error("Unable to set length of List")}},data:{set:function(){throw new Error("Unable to set data of List")}}},methods:{init:function(b){this.inherited(),this._counting_map=new a.Counter,this._counting_num=0,this._counting_res=null,this._length=0,this._data=[],a.is(b,"Array")?this.spliceAll(0,0,b.slice()):a.is(b,i)&&this.spliceAll(0,0,b._data.slice())},toArray:function(){return this._data.slice()},slice:function(a,b){return new i(c.call(this._data,a,b))},get:function(a){return a>=0?this._data[a]:0>a?this._data[this._data.length+a]:void 0},each:function(b,c){return a.each(this._data,b,c)},__each__:function(b,c){return a.each(this._data,b,c)},contains:function(a){return this._data.indexOf(a)>=0},indexOf:function(a,b){return this._data.indexOf(a,b)},lastIndexOf:function(a,b){return void 0===b?this._data.lastIndexOf(a):this._data.lastIndexOf(a,b)},find:function(a){if(this._data.find)return this._data.find(a);var b;for(b=0;b<this._data.length;b++)if(a(this._data[b]))return this._data[b]},findIndex:function(a){if(this._data.find)return this._data.findIndex(a);var b;for(b=0;b<this._data.length;b++)if(a(this._data[b]))return b;return-1},push:function(){return this.spliceAll(this._data.length,0,c.call(arguments)),this._data.length},pushAll:function(a){return this.spliceAll(this._data.length,0,a),this._data.length},pop:function(){return this.spliceAll(this._data.length-1,1,[])[0]},unshift:function(){return this.spliceAll(0,0,c.call(arguments)),this._data.length},unshiftAll:function(a){return this.spliceAll(0,0,a),this._data.length},shift:function(){return this.spliceAll(0,1,[])[0]},splice:function(a,b){return this.spliceAll(a,b,c.call(arguments,2))},spliceAll:function(a,b,c){0>a&&(a=this._length+a),0>b&&(b=0),a+b>this._length&&(a>this._length&&(a=this._length),b=this._length-a);var d=this.differ([["splice",a,b,c]]);return d.drops[0]},remove:function(){return this.removeAll(c.call(arguments))},removeAll:function(a){if(!a)return this.clear().length;var b,c,d,e=0,f=[];for(b=0;b<a.length;b++)for(d=a[b];(c=this.indexOf(d,c+1))>=0;)f.push(["splice",c,1,[]]),e++;return f.sort(function(a,b){return b[1]-a[1]}),this.differ(f),e},clear:function(){var a=this.differ([["splice",0,this._length,[]]]);return a.drops[0]},toggle:function(a,b){return arguments.length>1?(b?this.indexOf(a)<0&&this.push(a):this.remove(a),b):this.indexOf(a)>=0?(this.remove(a),!1):(this.push(a),!0)},setIndex:function(a,b){var c=this.indexOf(a);if(-1===c){var d=this.differ([["splice",b,0,[a]]]);return d.diffs[0][1]}return c+this.move(c,1,b-c)},setIndexAt:function(a,b){var c=this._length;return 0>a&&(a=c+a),0>a||a>=c?0:a+this.move(a,1,b-a)},move:function(a,b,c){var d,e=this._length;return 0>a&&(a=e+a),0>a||a>=e?0:(a+b>e?b=e-a:0>b&&(0>a+b?(b=a,a=0):(b=-b,a-=b)),0>=b?0:(a+b+c>e?c=e-a-b:0>a+c&&(c=-a),0===c?0:(d=c,0>c&&(b=c-b,c-=b,b=c+b,b=-b,a-=b),this.differ([["move",a,b,c]]),d)))},differ:function(a){var b=this._length,c=this._differ(a);return c&&c.diffs.length&&(this.fire("diff",c),b!==this._data._length&&(this._length=this._data.length,this.notify("length"))),c},_differ:function(c){var d=[],e=[];return a.each(c,function(c){switch(c[0]){case"splice":d.push(a.func.apply(b,this._data,c[1],c[2],c[3])),e.push(c[3]);break;case"move":a.func.apply(b,this._data,c[1]+c[3],0,this._data.splice(c[1],c[2])),d.push([]),e.push([])}},this),{diffs:c||[],drops:d,joins:e}},_counting_register:function(){this._counting_num++;var b=this._counting_map;return this._counting_num>0&&(this._counting_res||(b.clear(),a.each(this._data,function(a){b.increase(a)}),this._counting_res=this.on("diff",function(c,d){var e,f,g,h,i,j,k,l=new a.Counter;for(i=d.diffs,j=d.drops,k=d.joins,e=0;e<i.length;e++)f=i[e],g=j[e],h=k[e],a.each(g,function(a){l.decrease(a)}),a.each(h,function(a){l.increase(a)});var m=[];l.each(function(a,c){(a>0||0>a)&&(b.increase(c,a),m.push({value:c,count:b.get(c)}))}),this.fire("counting",m)},this))),{release:function(){this._counting_num--,this._counting_num<=0&&this._counting_res&&(this._counting_res.release(),this._counting_res=null)}.bind(this)}},monitorDiff:function(a,b){var c=this,d=this._data.slice();d.length&&a.call(b,{diffs:Array(["splice",0,0,d]),drops:Array([]),joins:[d]});var e=this.on("diff",function(c,d){a.call(b,d)});return{release:function(){if(e){var d=c._data.slice();d.length&&a.call(b,{diffs:Array(["splice",0,d.length,[]]),drops:[d],joins:Array([])}),e.release()}}}},monitorContaining:function(b,c){var d=(this._counting_map,new a.Map),e=function(a,b){"function"==typeof b&&(b={release:b}),b&&"function"==typeof b.release&&d.set(a,b)},f=this._counting_register(),g=this.on("counting",function(f,g){a.each(g,function(a){var f,g=d.get(a.value);g?a.count<=0&&(g.release(),d.remove(a.value)):a.count>0&&(f=b.call(c,a.value),e(a.value,f))})},this);return a.each(this._data,function(a){
var d=b.call(c,a);e(a,d)},this),{release:function(){g&&(d.each(function(a,b){a.release()}),d.clear(),g.release(),g=null),f&&(f.release(),f=null)}}},monitorCounting:function(b,c){var d=this._counting_map,e=new a.Map,f=this._counting_register(),g=this.on("counting",function(d,f){a.each(f,function(a){var d=e.get(a.value);d?(d(a.count),a.count<=0&&e.remove(a.value)):a.count>0&&(d=b.call(c,a.value,a.count),d&&e.set(a.value,d))})},this);return a.each(d,function(a,d){var f=b.call(c,d,a);f&&e.set(d,f)},this),{release:function(){g&&(e.each(function(a,b){a(0)}),e.clear(),g.release(),g=null),f&&(f.release(),f=null)}}}},statics:{getListSyncMonitor:function(a,b){return b!==!1?function(b){return a.push(b),function(){a.remove(b)}}:function(b){return a.remove(b),function(){a.push(b)}}},buildExpressionTree:function(){var a=[["-"],["&"],["^"],["|"],["&&"],["||"]],b=function(b){for(var c=0;c<a.length;c++)if(a[c].indexOf(b)>=0)return c},c=function(a,b,c){return"[object Array]"===Object.prototype.toString.call(b)&&b[0]===a?(b.push(c),b):[a,b,c]};return function(a){"string"==typeof a&&(a=a.match(e)),a=a.concat([")"]);for(var d,h,i,j=[],k=[],l=[];a.length;)if(d=a.shift(),")"===d)for(;(h=j.pop())&&"("!==h;)i=k.pop(),k.push(c(h,k.pop(),i));else if("("===d)j.push(d);else if(d.match(f))k.push(d),-1==l.indexOf(d)&&l.push(d);else if(d.match(g)){for(;j.length;){if(h=j.pop(),"("===h||b(h)>b(d)){j.push(h);break}i=k.pop(),k.push(c(h,k.pop(),i))}j.push(d)}return k[0]&&(k[0].operands=l),k[0]}}(),calculate:function(b,c){if(!b.match(d))throw new Error("Bad expression.");a.is(c,a.Map)||(c=new a.Map(c));var g=b.match(e),h=g.filter(RegExp.prototype.test.bind(f)),j=i.buildExpressionTree(g),k=new a.List,l={count:0,map:{},sync:function(){if(l.count===h.length){var a;"string"==typeof j?a=c.get(j):(k.retain(a),a=i.calculateTree(j,c)),k.retain(a.monitorContaining(i.getListSyncMonitor(k)))}},monitor:function(a,b){h.indexOf(a)>=0&&(l.count+=1*!l.map[a]+1*!!b-1,l.map[a]=b,l.sync())}};return k.retain(c.monitor(l.monitor)),k},calculateTree:function(b,c){var d,e,f=b[0];switch(f){case"&&":d=new a.List,e=function(f){var g,h;return"string"==typeof b[f]?(g=c.get(b[f]),h=new a.Object):h=g=i.calculateTree(b[f],c),f>=b.length-1?h.retain(g.monitorContaining(i.getListSyncMonitor(d))):h.retain(g.watch("length",function(a,b){return b?e(f+1):void 0})),h},d.retain(e(1));break;case"||":d=new a.List,e=function(f){var g,h;return"string"==typeof b[f]?(g=c.get(b[f]),h=new a.Object):h=g=i.calculateTree(b[f],c),f>=b.length-1?h.retain(g.monitorContaining(i.getListSyncMonitor(d))):h.retain(g.watch("length",function(a,b){return b?g.monitorContaining(i.getListSyncMonitor(d)):e(f+1)})),h},d.retain(e(1));break;default:d=function(){var d,e,g,j=[],k=[];for(e=1;e<b.length;e++)"string"==typeof b[e]?g=c.get(b[e]):(g=i.calculateTree(b[e],c),j.push(g)),k.push(g);return d=i[h[f]](k),a.each(j,function(a){d.retain(a)}),d}()}return d},select:function(b,c,d){if(!a.is(b,i))return null;"function"==typeof c&&(d=c,c=null),d||(d=a.identity);var e=new i;return e.retain(b.monitorContaining(function(b){var f;return c?a.is(b,a.Object)?f=a.Object.cascade(b,c,function(){e.toggle(b,d.apply(e,arguments))}):e.toggle(b,d.call(e,a.path(b,c))):e.toggle(b,d.call(e,b)),function(){f&&f.release(),e.toggle(b,!1)}})),e},summarize:function(b,c){return sum=0,b.monitorDiff(function(b){a.each(b.diffs,function(c,d){var e=b.drops[d],f=b.joins[d],g=a.math.plus.apply(this,f)-a.math.plus.apply(this,e);g&&(sum+=g)}),c(sum)})},sorting:function(a,b){},cross:function(b){var c=new a.List,d=new a.Counter;return a.is(b,Array)&&(b=new a.List(b)),c.retain(d.on("increase",function(a,d){d.count==b.length()&&c.push(d.item)})),c.retain(d.on("decrease",function(a,d){d.count==b.length()-1&&c.remove(d.item)})),c.retain(b.monitorContaining(function(a){return a.monitorContaining(function(a){return d.increase(a,1),function(){d.decrease(a,1)}})})),c},union:function(b){var c=new a.List,d=new a.Counter;return a.is(b,Array)&&(b=new a.List(b)),c.retain(d.on("increase",function(a,b){1===b.count&&c.push(b.item)})),c.retain(d.on("decrease",function(a,b){0===b.count&&c.remove(b.item)})),c.retain(b.monitorContaining(function(a){return a&&a.monitorContaining(function(a){return d.increase(a,1),function(){d.decrease(a,1)}})})),c},complement:function(b){var c=new a.List,d=new a.Counter,e=b.length;return c.retain(d.on("count",function(a,b){var d=b.previousCount,f=b.count;e>d&&f>=e&&c.push(b.item),d>=e&&e>f&&c.remove(b.item)})),c.retain(b[0].monitorContaining(function(a){return d.increase(a,e),function(){d.decrease(a,e)}})),a.each(b,function(a,b){b>0&&c.retain(a.monitorContaining(function(a){return d.decrease(a),function(){d.increase(a)}}))}),c},delta:function(b){var c=new a.List;return a.each(b,function(a){c.retain(a.monitorContaining(function(a){return c.toggle(a),function(){c.__released__||c.toggle(a)}}))}),c},and:function(b){var c=new a.List,d=function(a){var e=b[a];return a===b.length-1?e.monitorContaining(function(a){return c.push(a),function(){c.__released__||c.remove(a)}}):e.watch("length",function(b,c){return c?d(a+1):void 0})};return c.retain(d(0)),c},or:function(b){var c=new a.List,d=function(a){var e=b[a];return e.watch("length",function(f,g){return a<b.length-1&&!g?d(a+1):e.monitorContaining(function(a){return c.push(a),function(){c.__released__||c.remove(a)}})})};return c.retain(d(0)),c}}})}(nx),function(a){var b=a.global;Array.prototype.splice,Array.prototype.slice,Object.prototype.hasOwnProperty,Math.sign||a.math.sign;a.path(b,"nx.List.slicing",function(b,c,d){var e=new a.List;return e.retain(b.monitorDiff(function(f){var g=!1;a.each(f.diffs,function(a,b){switch(a[0]){case"splice":if(a[1]<d){if(a[1]+a[2]>=c)return g=!0,!1;if(a[3].length!==a[2])return g=!0,!1}break;case"move":if(a[1]<=c&&a[1]+a[2]+a[3]>=d)return g=!0,!1}}),g&&e.spliceAll(0,d-c,b.data().slice(c,d))})),e})}(nx),function(a){var b=a.global,c=Array.prototype.splice,d=(Array.prototype.slice,Object.prototype.hasOwnProperty);Math.sign||a.math.sign;a.path(b,"nx.List.mapping",function(b,e,f,g){var h=a.binding(e,f,g),i=new a.List,j={listeners:[],shift:function(a,b){var c;for(c=a;c<j.listeners.length;c++)j.listeners[c].index+=b},listen:function(b,c){var e,f;return e={index:c,set:function(a){d.call(e,"value")&&i.splice(e.index,1,a),e.value=a},release:function(){f&&f.release(),f=null}},h.paths&&h.paths.length?f=a.Object.binding(b,h,function(a){e.set(a)}):h.async?f=h.handler({get:function(){return e.value},set:e.set},b):e.set(h.handler(b)),e},release:function(){a.each(j.listeners,function(a){a.release()})},move:function(b,d,e){var f,g,h=j.listeners,i=[[b,d,e],e>0?[b+d,e,-d]:[b+e,-e,d]];a.each(i,function(a){for(f=0;f<a[1];f++)g=h[a[0]+f],g.index+=a[2]}),a.func.apply(c,j.listeners,b+e,0,j.listeners.splice(b,d))}};return b.each(function(a,b){var c=j.listen(a,b);i.push(c.value),j.listeners.push(c)}),i.retain(j),i.retain(b.on("diff",function(b,d){var e=[];a.each(d.diffs,function(b,f){var g,h,i,k,l;switch(b[0]){case"splice":i=b[1],g=d.drops[f],h=d.joins[f],l=h.map(function(a,b){return j.listen(a,i+b)}),k=l.map(function(a){return a.value}),j.shift(i+g.length,h.length-g.length),g=a.func.apply(c,j.listeners,i,g.length,l),a.each(g,function(a){a.release()}),e.push(["splice",i,g.length,k]);break;case"move":j.move(b[1],b[2],b[3]),e.push(b.slice())}}),e.length&&i.differ(e)})),i})}(nx),function(a){var b=a.global,c=(Array.prototype.splice,Array.prototype.slice,Object.prototype.hasOwnProperty,Math.sign||a.math.sign,function(a){return Math.max(a,0)}),d=Math.floor,e=Math.ceil;a.path(b,"nx.List.tuple",function(b,f,g,h,i){1*g>=0?g=1*g:(i=h,h=g,g=1),"string"==typeof h&&(h=h.replace(/\s/g,"").split(",")),a.is(h,Array)||(i=h,h=["items"]),"function"!=typeof i&&(i=function(a,b){return b});var j,k;k=a.binding(h,function(){var b=this.retain("update");return b.retain()||(b=this.retain("update",new a.Object)),a.func.apply(this,b,arguments)}),j=a.define({properties:{total:0,index:-1,items:null,value:null}});var l={insensitive:1===h.length&&"items"===h[0],items:[],tuples:new a.List,shift:function(a,b,c){if(!l.locked){var d,e,f;for(d=a;d<l.resources.length;d++)e=l.resources[d],f=e["_"+b+"$sum"],e[b+"$sum"].call(e,f+c)}},splice:function(k,m,n){var o,p,q,r,s,t,u,v,w,x,y,z,A=l.items,B=l.tuples;r=k+m,s=k+n.length,q=s-r,t=A.length,u=A.length+s-r,v=c(d((t-f+g)/g)),w=c(d((u-f+g)/g)),x=w-v,y=c(d((k-f+g)/g)),z=e(s/g),x>0?(o=Array(x).join(",").split(",").map(function(){return new j}),B.spliceAll(y,0,o)):0>x&&(p=B.splice(y,-x),p.map(function(a){a.release()})),a.func.apply(A.splice,A,k,m,n);var C,D,E,F;for(C=y;w>C;C++){if(E=C*g,D=B.get(C),l.insensitive&&C>=z&&q%g===0){if(D.index()!==E)for(D.index(E),C++;w>C;C++)B.get(C).index(C*g);break}D.total(A.length),D.index(E),D.items(A.slice(E,E+f)),F=h.map(function(b){return a.path(D,b)}),resources=D.retain("update"),resources&&resources.retain()||(resources=D.retain("update",new a.Object)),F.unshift(resources),D.value(i.apply(b,F))}},move:function(j,k,m){var n,o,p,q=l.items,r=l.tuples;n=c(d((j-f+g)/g)),o=c(d((q.length-f+g)/g)),p=Math.min(o,e((j+k+m)/g)),a.func.apply(q.splice,q,j,0,q.splice(j+k,m));var s,t,u,v;for(s=n;p>s;s++)u=s*g,t=r.get(s),t.items(q.slice(u,u+f)),v=h.map(function(b){return a.path(t,b)}),resources=t.retain("update"),resources&&resources.retain()||(resources=t.retain("update",new a.Object)),v.unshift(resources),t.value(i.apply(b,v))}};l.tuples.retain(b.monitorDiff(function(b){a.each(b.diffs,function(a,c){switch(a[0]){case"splice":var d=a[1],e=b.drops[c],f=b.joins[c];l.splice(d,e.length,f);break;case"move":l.move(a[1],a[2],a[3])}})}));var m=a.List.mapping(l.tuples,"value");return m.retain(l.tuples),m})}(nx),function(a){var b=a.global,c=Array.prototype.splice,d=(Array.prototype.slice,Object.prototype.hasOwnProperty,Math.sign||a.math.sign);a.path(b,"nx.List.mapeach",function(b,e,f){"string"!=typeof e&&(f=e,e="$origin");var g=new a.List;f=function(b){var c,d={};if(a.each(b,function(b,f){var g={};a.is(b,a.binding)||(b=a.is(b,"String")||a.is(b,"Function")?a.binding(b):a.is(b,"Array")?a.binding.apply(b):b.paths||b.handler?a.binding(b):a.binding(function(a){return function(){return a}}(b))),"$origin"===e&&b.paths&&(b.paths=b.paths.map(function(a){return e+"."+a})),"+"===f.charAt(0)?(g.summarize="0",f=f.substring(1)):"+"===f.charAt(f.length-1)&&(g.summarize="1",f=f.substring(0,f.length-1)),g.binding=b,g.path=f,d[f.replace(/\./g,"\\$")]=g,c=!0}),!c&&"$origin"===e)throw new Error("Missing mapping definition.");return d}(f);var h,i=function(){var b={};return b.index=-1,b[e]=null,a.each(f,function(a,c){var d={};d.value=a.binding,b[c+"$value"]=d,a.summarize&&(d.watcher=function(a,b,d){this._index>=0&&h.shift(this._index+1,c,(b||0)-(d||0))},b[c+"$sum"]=null)}),"$origin"!==e&&a.each(f,function(a,c){-1===c.indexOf("$")&&(b[c]=null)}),a.define({properties:b})}();return h={values:[],resources:[],locked:!1,create:function(a){var b=new i;return b[e].call(b,a),b},lock:function(a){h.locked=!0,a(),h.locked=!1},shift:function(a,b,c){if(!h.locked){var d,e,f;for(d=a;d<h.resources.length;d++)e=h.resources[d],f=e["_"+b+"$sum"],e[b+"$sum"].call(e,f+c)}},splice:function(b,d,e,g,i){var j,k,l,m,n=(a.func.apply(c,h.values,b,d,g),a.func.apply(c,h.resources,b,d,e));for(a.each(e,function(a,c){a.index(b+c)}),k=e.length-n.length,l={},a.each(f,function(c,d){var f,g,i,j=c.summarize;j&&(i=h.resources[b-1],f=i?i["_"+d+"$sum"]:0,g=i?i["_"+d+"$value"]:0),a.each(n,function(a){j&&(l[d]=l[d]||0,l[d]-=a["_"+d+"$value"]||0)}),a.each(e,function(a,b){j&&(l[d]=l[d]||0,l[d]+=a["_"+d+"$value"]||0,f+=g,g=a["_"+d+"$value"],a[d+"$sum"].call(a,f))})}),i(n),a.each(f,function(b,c){var d=b.path,f=b.summarize;a.each(e,function(b,e){var h=g[e];-1!==c.indexOf("$")||h[c]||a.Object.extendProperty(h,c,{});var i=function(){switch(f){case"0":return a.binding(c+"$sum");case"1":return a.binding(c+"$value,"+c+"$sum",function(a,b){return a+b});default:return a.binding(c+"$value")}}();b.retain(a.Object.binding(b,i,function(b){a.path(h,d,b)}))})}),j=b+e.length;j<h.resources.length;j++)m=h.resources[j],m.index(m.index()+k),a.each(l,function(a,b){var c=m["_"+b+"$sum"];m[b+"$sum"].call(m,c+a)})},move:function(b,e,g){var i,j=[[b,e,g,{}],g>0?[b+e,g,-e,{}]:[b+g,-g,e,{}]];a.each(j,function(b,c){var d,e,g=h.resources;for(d=0;d<b[1];d++)e=g[b[0]+d],a.each(f,function(a,c){a.summarize&&(b[3][c]=(b[3][c]||0)+e["_"+c+"$value"])})}),i=j[0][3],j[0][3]=j[1][3],j[1][3]=i,a.each(j,function(b,c){var e,f,g=d(b[2]),i=h.resources;for(e=0;e<b[1];e++)f=i[b[0]+e],f.index(f._index+b[2]),a.each(b[3],function(a,b){var c=f["_"+b+"$sum"];f[b+"$sum"].call(f,c+g*a)})}),a.func.apply(c,h.resources,b+g,0,h.resources.splice(b,e))}},g.retain(b.monitorDiff(function(b){var c=[];a.each(b.diffs,function(d,f){switch(d[0]){case"splice":var g=d[1],i=b.drops[f],j=b.joins[f],k=j.map(h.create),l=j.map(function(a,b){return"$origin"===e?a:k[b]});h.lock(function(){h.splice(g,i.length,k,l,function(b){a.each(b,function(a){a.release()})})}),(i.length||l.length)&&d&&c.push(["splice",g,i.length,l]);break;case"move":h.lock(function(){h.move(d[1],d[2],d[3])}),c.push(d.slice())}}),c.length&&g.differ(c)})),g})}(nx),function(a){var b=a.global,c=Array.prototype.splice,d=(Array.prototype.slice,Object.prototype.hasOwnProperty,Math.sign||a.math.sign);a.path(b,"nx.List.concatenate",function(b,e){"boolean"!=typeof b&&(e=b,b=!1),a.is(e,"Array")&&(e=new a.List(e));var f=new a.List,g={diffs:[],resources:[],affect:function(){f.differ(g.diffs||[]),g.diffs=[]},differ:function(a,c){g.diffs=g.diffs.concat(a),b&&!c||g.affect()},shift:function(a,b,c){var d;for(d=a;d<g.resources.length;d++)g.resources[d].index+=b,g.resources[d].start+=c},create:function(b){var c=new a.Object;return c.retain(b.on("diff",function(a,b){c.differ(b.diffs)})),c.differ=function(a){a=a.slice();var b,d,e=0;for(b=0;b<a.length;b++)switch(d=a[b]=a[b].slice(),d[1]+=c.start,d[0]){case"splice":e-=d[2],e+=d[3].length;break;case"move":}c.length+=e,e&&g.shift(c.index+1,0,e),g.differ(a)},c},splice:function(b,d,e,f,h){var i,j,k,l,m,n=a.func.apply(c,g.resources,b,d,e);return m=l=g.resources[b-1]?g.resources[b-1].start+g.resources[b-1].length:0,i=e.length-n.length,j=0,k=[],a.each(n,function(a){j+=a.length}),a.each(e,function(a,c){var d=f[c];a.index=b+c,a.start=m,a.length=d.length(),m+=a.length,k=k.concat(d.data())}),h(n),(i||k.length-j)&&g.shift(b+e.length,i,k.length-j),j||k.length?["splice",l,j,k]:void 0},move:function(b,e,f){var h,i=g.resources,j=i[b].start,k=[[b,e,f,0],f>0?[b+e,f,-e,0]:[b+f,-f,e,0]];return a.each(k,function(a,b){var c,d,e=g.resources;for(c=0;c<a[1];c++)d=e[a[0]+c],a[3]+=d.length}),h=k[0][3],k[0][3]=k[1][3],k[1][3]=h,a.each(k,function(a,b){var c,e,f=d(a[2]),h=g.resources;for(c=0;c<a[1];c++)e=h[a[0]+c],e.index+=a[2],e.start+=f*a[3]}),a.func.apply(c,g.resources,b+f,0,g.resources.splice(b,e)),k[0][3]&&k[1][3]?["move",j,k[1][3],d(f)*k[0][3]]:void 0},release:function(){g.affect(),a.each(g.resources,function(a){a.release()})}};return f.retain(g),f.retain(e.monitorDiff(function(b){var c=[];a.each(b.diffs,function(d,e){var f,h,i,j;switch(d[0]){case"splice":var f=d[1],h=b.drops[e],i=b.joins[e],j=i.map(g.create);d=g.splice(f,h.length,j,i,function(b){a.each(b,function(a){a.release()})});break;case"move":d=g.move(d[1],d[2],d[3])}d&&c.push(d)}),c.length&&g.differ(c,!0)})),f})}(nx),function(a){var b=a.global,c=(Array.prototype.splice,Array.prototype.slice,Object.prototype.hasOwnProperty,Math.sign||a.math.sign);a.path(b,"nx.List.sorting",function(b,d,e){if("function"==typeof d&&(e=d,d=null),"string"==typeof d&&(d=d.replace(/\s/g,"").split(",")),d&&a.is(d,Array)?1===d.length&&"self"===d[0]&&(d=null):d=null,!e){if(d&&d.length>1)throw new Error("List.sorting with multiple paths cannot ignore comparator");e=function(a,b){return a-b}}var f=new a.List,g={vectors:[],map:new a.Map,position:function(c,d){if(!d)return a.array.findIndex(g.vectors,function(a){return a.item===c});var f,h,i,j,k=g.vectors;for(f=0;f<k.length;f++)if(i=k[f],i.item!==c){if(j=e.apply(b,d.concat(i)),0>j)break;if(0==j&&h>=0)break}else h=f;return h>=0?f-1:f},counting:function(b,c){c=c||0;var d,e,h,i,j;for(e=g.vectors,i=g.position(b),h=g.vectors[i],j=c-h.count,0>j&&f.splice(h.start,-j),j>0&&f.spliceAll(h.start,0,a.array.times(j,b)),h.count=c,d=i+1;d<e.length;d++)e[d].start+=j;0==c&&g.vectors.splice(i,1)},changing:function(a,b){var c=(g.vectors,g.position(a)),d=g.position(a,b);0>c?g.inserting(a,b,d):g.moving(a,b,c,d)},inserting:function(a,b,c){var d=g.vectors,e=b.slice();e.item=a,e.count=0,0==c?e.start=0:e.start=d[c-1].start+d[c-1].count,d.splice(c,0,e)},moving:function(a,b,d,e){if(d!=e){var h,i;i=g.vectors,h=i[d];var j,k,l,m;for(l=c(e-d),m=0,j=d;j!=e;j+=l)k=i[j+l],m+=l*k.count,k.start-=l*h.count;f.move(h.start,h.count,m),i.splice(d,1),i.splice(e,0,h),h.start+=m}}};return f.retain(b.monitorCounting(function(b,c){var e;return d?e=a.Object.cascade(b,d,function(){var a=Array.prototype.slice.call(arguments,0,d.length);g.changing(b,a)}):g.changing(b,[b]),g.counting(b,c),function(a){g.counting(b,a),0==a&&e&&e.release()}})),f})}(nx),function(a){var b=a.array.count;a.define("nx.UniqueList",a.List,{methods:{init:function(a){this.inherited(a),this.retain(this._counting_register())},_differ:function(a){for(c=0;c<a.length;c++){var c,d,e,f,g,h,i=this._data;if(1===a.length){switch(g=a[0],h=this._counting_map,g[0]){case"splice":for(e=g[3],f=i.slice(g[1],g[1]+g[2]),c=e.length;c>=0;c--)d=e[c],h.get(d)+b(e,d)-b(f,d)>1&&(e===g[3]&&(e=e.slice(),a=[["splice",g[1],g[2],e]]),e.splice(c,1))}return a&&a.length?this.inherited(a):null}var j=this.inherited(a);for(c=i.length;c>0;c--)d=i[c],i.indexOf(d)!==c&&(i.splice(c,1),j.diffs===a&&(j.diffs=j.diffs.slice()),j.diffs.push(["splice",c,1,[]]),j.drops.push([d]),j.joins.push([]));return j}return this.inherited(a)}}})}(nx),function(a){a.template=function(b,c,d,e){if(!(this instanceof a.template))return new a.template(b,c,d,e);if(arguments.length){var f;b instanceof a.binding?(f=b,e=c):("function"==typeof b?(e=c,d=b,c=!1,b=[]):"boolean"==typeof b?(e=d,d=c,c=b,b=[]):"function"==typeof c?(e=d,d=c,c=!1):"string"==typeof b||a.is(b,"Array")?"function"==typeof c?(e=d,d=c,c=!1):"boolean"!=typeof c&&(e=c,d=null,c=!1):a.is(b.source,a.binding)?(e=b.pattern,f=b.source):(e=b.pattern,d=b.handler,c=!!b.async,b=b.paths||[]),f||(f=a.binding(b,c,d))),this.binding=f,this.pattern=a.is(e,"Array")?e:[e]}}}(nx),function(a){var b=["name","events","properties","content","extend"],c=/^\{([^\}]*)\}$/,d=/\{([^\}]*)\}/g,e=/\s/g,f=a.define("nx.Hierarchical",{properties:{parent:null,childDefaultType:"nx.Hierarchical",childList:{set:function(){throw new Error("Unable to set child list out of Hierarchical.")}},hierarchicalSyncParent:a.binding("childList",function(b){var c=this;this.release("hierarchicalSyncParent"),a.is(b,a.List)&&this.retain("hierarchicalSyncParent",b.monitorDiff(function(b){a.each(b.diffs,function(d,e){var g=b.drops[e],h=b.joins[e];a.each(g,function(b){a.is(b,f)&&b.parent(null)}),a.each(h,function(b){a.is(b,f)&&b.parent(c)})})}))})},methods:{init:function(){this.inherited(),this._childList=new a.List,this.notify("childList"),this.initHierarchical()},initHierarchical:function(){var c,d=this,e=d.constructor,g=[];do c=e.__meta__.hierarchical,c&&g.unshift(c),e=e.__super__;while(e&&e!==f);a.each(g,function(c){d.__hierarchical__=d.__hierarchical__||{},a.each(c,function(a,c){if(b.indexOf(c)>=0)throw new Error("Cannot use hierarchical keyword: "+c);d.__hierarchical__[c],d.__hierarchical__[c]=a})})},hierarchicalUpdate:function(b,c){var d=this;c=c||d;var e=new a.Object;return a.each(d.__hierarchical__,function(a,f){b[f]&&e.retain(a.call(d,b[f],c))}),a.each(b.events,function(a,b){e.retain(d.hierarchicalUpdateEvent(b,a,c))}),a.each(b.properties,function(a,b){e.retain(d.hierarchicalUpdateProperty(b,a,c))}),e.retain(d.hierarchicalAppend(b.content,c)),a.each(b.extend,function(b,g){var h=a.path(d,g);if(h){if(b.type)throw new Error("Cannot specify type while extending existing self: "+g);e.retain(h.hierarchicalUpdate(b,c))}else h=f.create(d,b),f.extendProperty(d,g,h),e.retain(h.hierarchicalUpdate(b,c))}),e},hierarchicalAppend:function(b,c,d){var e,g=this;return b||0===b?a.is(b,Array)?g.hierarchicalAppendArray(b,c,d):"string"==typeof b?g.hierarchicalAppendString(b,c,d):"number"==typeof b?g.hierarchicalAppendNumber(b,c,d):a.is(b,f)?g.hierarchicalAppendChildren([b],c,d):b instanceof a.binding?g.hierarchicalAppendBinding(b,c,d):!a.is(b,a.Object)&&b.existence?g.hierarchicalAppendObjectExistence(b,c,d):b instanceof a.template||!a.is(b,a.Object)&&b.repeat?(e=f.getTemplateByObject(b)||b,g.hierarchicalAppendTemplate(e,c,d)):g.hierarchicalAppendObject(b,c,d):a.Object.IDLE_RESOURCE},hierarchicalAppendObject:function(b,c,d){var e,g,h=this,i=new a.Object;return g=f.getBindingIfString(b.type),g?(b=a.clone(b),c=c||h,d=f.getFlatList(h,!1,d),i.retain(d),i.retain(a.Object.binding(c,g,function(a){i.release("recursive"),b.type=a,i.retain("recursive",h.hierarchicalAppendObject(b,c,d))}))):(e=f.create(h,b),b.name&&f.extendProperty(c,b.name,e),a.is(e,f)&&e.retain(e.hierarchicalUpdate(b,c)),i.retain(e),i.retain(h.hierarchicalAppendChildren([e],c,d))),i},hierarchicalAppendArray:function(b,c,d){var e=this,f=new a.Object;return a.each(b,function(a){f.retain(e.hierarchicalAppend(a,c,d))}),f},hierarchicalAppendString:function(b,c,d){var e=this;return binding=f.getBindingIfString(b),binding?e.hierarchicalAppendBinding(binding,c,d):a.Object.IDLE_RESOURCE},hierarchicalAppendNumber:function(b,c,d){return a.Object.IDLE_RESOURCE},hierarchicalAppendChildren:function(b,c,d){var e=this,g=new a.Object;return c=c||e,d=f.getFlatList(e,!0,d),d.spliceAll(d.length(),0,b),g.retain({release:function(){b&&(d.remove.apply(d,b),b=null)}}),g},hierarchicalAppendObjectExistence:function(b,c,d){var e=this;c=c||e;var g,h,i,h=new a.Object;return g=f.getBindingIfString(b.existence),b=a.extend({},b),delete b.existence,g?(h=new a.Object,i=!1,d=f.getFlatList(e,!1,d),h.retain(d),h.retain(a.Object.binding(c,g,function(a){!!a!==i&&(h.release("recursive"),a&&h.retain("recursive",e.hierarchicalAppend(b,c,d)))})),h):f.hierarchicalAppendObject(b,c,d)},hierarchicalAppendBinding:function(b,c,d){var e=this;c=c||e;var g=new a.Object;return d=f.getFlatList(e,!1,d),g.retain(d),g.retain(a.Object.binding(c,b,function(a){g.release("recursive"),g.retain("recursive",e.hierarchicalAppend(a,c,d))})),g},hierarchicalAppendTemplate:function(b,c,d){var e=this;c=c||e;var g=new a.Object;return d=f.getFlatList(e,!1,d),g.retain(d),g.retain(new a.HierarchicalTemplate(e,d,b,c)),g},hierarchicalUpdateEvent:function(b,c,d){var e=this,g=new a.Object;return"string"==typeof c&&(c=d[c]&&"method"===d[c].__type__?d[c]:f.getBindingIfString(c,!0)),c&&(a.is(c,a.binding)?g.retain(a.Object.binding(d,c,function(a){g.release("recursive"),g.retain("recursive",e.hierarchicalUpdateEvent(b,a,d))})):"function"==typeof c&&(b=b.indexOf(" ")>=0?b.split(" "):[b],a.each(b,function(a){g.retain(e.on(a,c,d))}))),g},hierarchicalUpdateProperty:function(b,c,d){var e=this;if(d=d||e,c=f.getBindingIfString(c)||c,a.is(c,a.binding)){var g=new a.Object;return a.Object.binding(d,c,function(a){g.release("recursive"),g.retain("recursive",e.hierarchicalUpdateProperty(b,a,d))})}return this.hierarchicalUpdatePropertyValue(b,c,d)},hierarchicalUpdatePropertyValue:function(b,c,d){var e=this;return a.path(e,b,c),a.Object.IDLE_RESOURCE}},statics:{extendProperty:function(b,c,d){b[c]&&(a.SILENT||console.warn("Property name conflict: "+c)),a.Object.extendProperty(b,c,{},!0),a.path(b,c,d)},create:function(b,c){var d,e;return d="string"==typeof c.type?a.path(global,c.type):c.type,d="function"==typeof d?d:b&&b.childDefaultType&&b.childDefaultType(),d="string"==typeof d?a.path(global,d):d,d=d||f,e=new d},getFlatListAppendList:function(b,c){var d,e;return c?(e=new a.List,e._flat={plain:!0,group:b,index:b.length()}):(e=a.List.concatenate(d=new a.List),d._hierarchical_concatenated=e,e._hierarchical_concatenate=d,e._flat={group:b,index:b.length()},e.retain({release:function(){b.remove(e)}})),b.push(e),e},getFlatList:function(b,c,d){var e,g;g=e=d||b._childList;var h,i;return e._flat&&!e._flat.plain?(h=e._hierarchical_concatenate,c?(g=h.get(-1),(!g||g._flat&&!g._flat.plain)&&(g=f.getFlatListAppendList(h,!0))):g=f.getFlatListAppendList(h,!1)):c?e!==b._childList&&(h=e._flat.group,g=h.get(-1),(!g||g._flat&&!g._flat.plain)&&(g=f.getFlatListAppendList(h,!0))):(e===b._childList?(h=new a.List([e]),i=a.List.concatenate(h),h._hierarchical_concatenated=i,i._hierarchical_concatenate=h,i._flat=e._flat||{},delete i._flat.plain,b._childList=i,b.notify("childList"),e._flat={plain:!0,group:h,index:0}):h=e._flat.group,g=f.getFlatListAppendList(h,!1)),g},getStringBindingByString:function(b){if(b.indexOf("{")>=0){if(c.test(b))return a.binding(b.substring(1,b.length-1));var f=[],g={};if(b.replace(d,function(a,b,c){if(b=b.replace(e,"")){-1===f.indexOf(b)&&f.push(b);var d=g[b]=g[b]||[];-1===d.indexOf(a)&&d.push(a)}return""}),f.length)return a.binding(f,function(){var c=arguments,d=b;return a.each(f,function(b,e){var f=c[e];"string"!=typeof f&&(f="number"==typeof f?""+f:f?a.is(f,a.Object)?f.__id__:"true":"false"),a.each(g[b],function(a){d=d.replace(a,f)})}),d})}return null},getBindingIfString:function(b,c){if(a.is(b,a.binding))return b;var d,e;return d=e=null,b&&"string"==typeof b&&("{"===b.charAt(0)&&"}"===b.charAt(b.length-1)?e=b.substring(1,b.length-1):c&&(e=b)),d||e&&a.binding(e)},getTemplateByObject:function(b){if(!b||a.is(b,a.template))return b;var c,d=b.repeat;return a.is(d,a.binding)?c=d:a.is(d,Array)?c=a.binding(function(){return d}):d&&"string"==typeof d&&("{"===d.charAt(0)&&"}"===d.charAt(d.length-1)&&(d=d.substring(1,d.length-1)),c=a.binding(d)),b=a.extend({},b),delete b.repeat,c&&a.template(c,b)}}})}(nx),flattree=function(a){treeof=function(a){var b=[a.__id__];return nx.each(a._hierarchical_concatenate,function(a){b.push(treeof(a))}),b};for(var b=treeof(a),c=[];a&&a._flat&&a._flat.group&&a._flat.group._hierarchical_concatenated;)c.unshift(a._flat.group._hierarchical_concatenated.__id__),a=a._flat.group._hierarchical_concatenated;return[c.join(">")+">",JSON.stringify(b)]},function(a){var b=a.Hierarchical;a.define("nx.HierarchicalTemplate",{properties:{parent:{},list:{},template:{},context:{}},methods:{init:function(b,c,d,e){this.inherited(),this.parent(b),this.list(c),this.template(d),this.context(e),this.retain(a.Object.cascade(this,"parent,list,template,context",function(a,b,c,d){b&&(this.release("target-list"),this.retain("target-list",b.monitorContaining(function(a){return function(){a.release()}}))),a&&b&&c&&(d=d||a,this.retain("initial",this.applyBinding(a,b,c.binding,c.pattern,d)))}))},applyBinding:function(b,c,d,e,f){var g=this,h=new a.Object;return h.retain(a.Object.binding(f,d,function(i){h.release("recursive"),a.is(i,a.binding)?h.retain("recursive",g.applyBinding(b,c,d,e,f)):a.is(i,a.List)?h.retain("recursive",g.applyList(b,c,i,e,f)):a.is(i,"Array")&&h.retain("recursive",g.applyList(b,c,new a.List(i),e,f))})),h},applyList:function(c,d,e,f,g){g=g||c;var h=a.List.mapeach(e,"model",{count:"list.length",parent:function(){return c},list:function(){return e},context:function(){return g},views:a.binding("parent, context, list, model",function(c,d,e,g){if(c&&d&&e){var h=this;this.release("views");var i=new a.Object;return this.retain("views",i),f.map(function(a){var d=b.create(c,a);return b.extendProperty(d,"scope",h),d.retain(d.hierarchicalUpdate(a,d)),i.retain(d),d})}})});return h.retain(h.monitorDiff(function(b){var c=[];a.each(b.diffs,function(a){var b=a.slice();switch(b[0]){case"splice":b[1]*=f.length,b[2]*=f.length,b[3]=b[3].reduce(function(a,b){return a.concat(b.views())},[]);break;case"move":b[1]*=f.length,b[2]*=f.length,b[3]*=f.length}c.push(b)}),d.differ(c)})),h}}})}(nx),function(a){var b=a.define("nx.geometry.Math",{statics:function(){function a(a){return function(c){var d=a(c);return b.approximate(d,0)?0:d}}return{approximate:function(a,b,c){c=c||1e-10;var d=a-b;return c>d&&d>-c},square:function(a){return a*a},sin:a(Math.sin),cos:a(Math.cos),tan:a(Math.tan),cot:function(a){var b=Math.tan(a);return b>1e10||-1e10>b?0:1/b}}}()})}(nx),function(a){a.define("nx.geometry.Rectangle",{statics:{getBound:function(b,c){a.is(b,"Array")&&(b={x:b[0],y:b[1]}),a.is(c,"Array")&&(c={width:c[0],height:c[1]});var d=c.width>0?b.x:b.x-c.width,e=c.height>0?b.y:b.y-c.height;return{x:d,y:e,left:d,top:e,width:Math.abs(c.width),height:Math.abs(c.height)}},isInside:function(a,b){return a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height},calcCentralizeMatrix:function(b,c,d,e,f){if(!(c.width>0&&c.height>0&&Math.abs(d.width)&&Math.abs(d.height)))return a.geometry.Matrix.I;var g=d.left||0,h=d.top||0,i=d.width,j=d.height;if(!f){var k=b[0][0],l=b[1][1],m=b[2][0],n=b[2][1];g=g*k+m,h=h*l+n,i*=k,j*=l}var o=c.width-2*e,p=c.height-2*e,q=Math.min(o/Math.abs(i),p/Math.abs(j)),r=e+o/2-q*(g+i/2),s=e+p/2-q*(h+j/2);return[[q,0,0],[0,q,0],[r,s,1]]},calcRectZoomMatrix:function(a,b,c){if(c){var d=b.width||b.height?Math.min(a.height/Math.abs(b.height),a.width/Math.abs(b.width)):1,e=a.width/2-d*(b.left-a.left+b.width/2),f=a.height/2-d*(b.top-a.top+b.height/2);return[[d,0,0],[0,d,0],[e,f,1]]}var d=b.width||b.height?Math.min(a.height/Math.abs(b.height),a.width/Math.abs(b.width)):1,e=a.left+a.width/2-d*(b.left+b.width/2),f=a.top+a.height/2-d*(b.top+b.height/2);return[[d,0,0],[0,d,0],[e,f,1]]}}})}(nx),function(a){var b=Math.sqrt,c=a.math.square,d=Math.abs,e=a.define("nx.geometry.Line",{statics:{getDistance:function(a,d,e,f){return b(c(e-a)+c(f-d))},getPointToSegment:function(a,c,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v;return e!=g||f!=h?(i=f-h,j=g-e,k=e*h-g*f,m=b(i*i+j*j),l=i*c-j*a,n=i*a+j*c+k,o=j*e-i*f+l,p=j*g-i*h+l,s=d(n)/m,q=-(k*i+j*l)/(i*i+j*j),r=-(k*j-i*l)/(i*i+j*j),o*p>0?d(o)<d(p)?(t=e,u=f,v=b(n*n+o*o)/m):(t=g,u=h,v=b(n*n+p*p)/m):(t=q,u=r,v=s),{pedal:{x:q,y:r,distance:s},closest:{x:t,y:u,distance:v}}):void 0},getPointParameters:function(a){return{x:a.length?a[0]:a.x,y:a.length?a[1]:a.y}},getLineParameters:function(a){if(!a.length)return a;var b=a[0],c=a[1],d=b.length?b[0]:b.x,e=c.length?c[0]:c.x,f=b.length?b[1]:b.y,g=c.length?c[1]:c.y,h=g-f,i=e-d,j=d*g-e*f;return{A:h,B:i,C:j}},getDistanceFromPointToSegment:function(a,b){var a=e.getPointParameters(a),b=e.getLineParameters(b);return(b.A*a.x+b.B*a.y+b.C)/Math.sqrt(b.A*b.A+b.B*b.B)},getPointProjectionOnLine:function(a,b){var a=e.getPointParameters(a),b=e.getLineParameters(b),c=b.A*a.y-b.B*a.x,d=b.A*b.A+b.B*b.B;return{x:-(b.A*b.C+b.B*c)/d,y:-(b.B*b.C-b.A*c)/d}}}})}(nx),function(a){var b=(a.geometry.Math,a.geometry.Vector,a.define("nx.geometry.BezierCurve",{statics:function(){function a(a){var b,c=[];for(b=0;b<a.length-1;b++)c.push([a[b],a[b+1]]);return c}function c(a){var b,c=[a[0][0]];for(b=0;b<a.length;b++)c.push(a[b][1]);return c}function d(a){var b=0,c=0,d=[];for(b=0;b<a.length&&(b!==a.length-1||1!==a[b]);b++){if("number"!=typeof a[b]||a[b]<=c||a[b]>=1)throw"Invalid bread point list: "+a.join(",");d.push((a[b]-c)/(1-c)),c=a[b]}return d}var e=function(){var a=[[],[1],[1,1]];return function(b){if(a[b])return a[b];var c,d=e(b-1),f=[];for(c=0;c<d.length-1;c++)f[c]=d[c]+d[c+1];return f.push(1),f.unshift(1),a[b]=f,f}}();return{slice:function(a,c,d){return 0===c?0===d?null:b.breakdown(a,d).beziers[0]:d?b.breakdown(a,c,d).beziers[1]:b.breakdown(a,c).beziers[1]},breakdown:function(e){var f=Array.prototype.slice.call(arguments,1);if(!f.length)throw"Invalid argument length: "+arguments.length;f=d(f);var g,h,i,j=[e[0]],k=[];for(h=a(e);f.length;)g=f.shift(),i=b.separate(h,g),j.push(i.point),k.push(c(i.left)),h=i.right;return j.push(e[e.length-1]),k.push(c(h)),{points:j,beziers:k}},separate:function(a,b){for(var c,d,e=1-b,f=function(a){return[a[0][0]*e+a[1][0]*b,a[0][1]*e+a[1][1]*b]},g=function(a,b){return[f([a[0],b[0]]),f([a[1],b[1]])]},h=function(a){var b,c=[];for(b=0;b<a.length-1;b++)c.push(g(a[b],a[b+1]));return c},i=[],j=[],k=a;k.length;)d=k[0],i.push([d[0],f(d)]),d=k[k.length-1],j.unshift([f(d),d[1]]),1==k.length&&(c=f(k[0])),k=h(k);return{point:c,left:i,right:j}},through:function(a,b){if(void 0===b&&(b=a.length-1),2>b)return null;var c=[];
if(2===b){var d=a[0],e=a[2],f=a[1],g=[(d[0]+e[0])/2,(d[1]+e[1])/2],h=[2*f[0]-g[0],2*f[1]-g[1]];c.push(d,h,e)}return c},byLength:function(c,d){d=d||1;var e={length:0,map:[],accumulate:function(){var b,f,g,h,i=e.separate(a(c),1),j=e.map;for(h=f=g=0;;){if(h=Math.round(f/d),j[h]||(j[h]=g),b=i.shift(),!b){j[h]=1;break}f+=b.length,g+=b.rate}e.length=f},separate:function(a,c){var d,f=a[0][0],g=a[a.length-1][1],h=e.distance(f,g);return e.approximate(a)?[{length:h,rate:c}]:(d=b.separate(a,.5),f=e.separate(d.left,c/2),g=e.separate(d.right,c/2),f.concat(g))},approximate:function(a){var b,c,e=a[0][0];for(b=0;b<a.length;b++)if(c=a[b][1],Math.abs(c[1]-e[1])+Math.abs(c[0]-e[0])>d)return!1;return!0},distance:function(a,b){var c=b[0]-a[0],d=b[1]-a[0];return Math.sqrt(c*c+d*d)}};e.accumulate();var f={length:e.length,mapped:function(a){return e.map[Math.round(e.length*a/d)]},slice:function(a,d){return b.slice(c,f.mapped(a),f.mapped(d))},breakdown:function(){var a=Array.prototype.slice.call(arguments).map(f.mapped);return a.unshift(c),b.breakdown.apply(this,a)}};return f}}}()}))}(nx),function(a){var b=a.define("nx.geometry.Vector",{statics:{approximate:function(b,c,d){if(!b||!c||b.length!=c.length)return!1;var e;for(e=0;e<b.length;e++)if(!a.geometry.Math.approximate(b[e],c[e],d))return!1;return!0},equal:function(a,b){if(!a||!b||a.length!=b.length)return!1;var c;for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0},plus:function(a,b){return[a[0]+b[0],a[1]+b[1]]},transform:function(b,c){var d=[[b.concat([1])]].concat(Array.prototype.slice.call(arguments,1));return a.geometry.Matrix.multiply.apply(a.geometry.Matrix,d)[0].slice(0,2)},multiply:function(a,c){return b.transform(a,[[c,0,0],[0,c,0],[0,0,1]])},abs:function(a,c){if(1==arguments.length)return Math.sqrt(a[0]*a[0]+a[1]*a[1]);var d=c/b.abs(a);return b.transform(a,[[d,0,0],[0,d,0],[0,0,1]])},reverse:function(a){return b.transform(a,[[-1,0,0],[0,-1,0],[0,0,1]])},rotate:function(c,d){var e=a.geometry.Math.sin(d),f=a.geometry.Math.cos(d);return b.transform(c,[[f,e,0],[-e,f,0],[0,0,1]])}}})}(nx),function(a){a.define("nx.geometry.MatrixSupport",{properties:{matrix:{value:function(){return a.geometry.Matrix.I}},transform_internal_:{dependencies:"matrix",value:function(b){if(!b)return this._transform_internal_||{x:0,y:0,scale:1,rotate:0};var c=NaN,d=NaN;return a.geometry.Matrix.isometric(b)&&(c=Math.sqrt(b[0][0]*b[0][0]+b[0][1]*b[0][1]),d=Math.atan2(b[1][0],b[0][0])),{x:b[2][0],y:b[2][1],scale:c,rotate:d}}},x:{value:0,set:function(a){return this._applyTransform("x",a),!1}},y:{value:0,set:function(a){return this._applyTransform("y",a),!1}},scale:{value:1,set:function(a){return this._applyTransform("scale",a),!1}},rotate:{value:0,set:function(a){return this._applyTransform("rotate",a),!1}}},methods:{init:function(){this.inherited(),this.retain(a.Object.affectBinding(this,"x",a.binding("transform_internal_.x",!0,function(a,b){isNaN(this._transform_internal_.x)||this._x===this._transform_internal_.x||(this._x=this._transform_internal_.x,this.notify(b))}.bind(this)))),this.retain(a.Object.affectBinding(this,"y",a.binding("transform_internal_.y",!0,function(a,b){isNaN(this._transform_internal_.y)||this._y===this._transform_internal_.y||(this._y=this._transform_internal_.y,this.notify("y"))}.bind(this)))),this.retain(a.Object.affectBinding(this,"scale",a.binding("transform_internal_.scale",!0,function(a,b){isNaN(this._transform_internal_.scale)||this._scale===this._transform_internal_.scale||(this._scale=this._transform_internal_.scale,this.notify(b))}.bind(this)))),this.retain(a.Object.affectBinding(this,"rotate",a.binding("transform_internal_.rotate",!0,function(a,b){isNaN(this._transform_internal_.rotate)||this._rotate===this._transform_internal_.rotate||(this._rotate=this._transform_internal_.rotate,this.notify(b))}.bind(this))))},getMatrixInversion:function(){var b=this.matrix();return b?a.geometry.Matrix.inverse(b):null},applyTranslate:function(b,c){this.matrix(a.geometry.Matrix.multiply(this.matrix(),[[1,0,0],[0,1,0],[b,c,1]]))},applyScale:function(b,c){c?this.matrix(a.geometry.Matrix.multiply(this.matrix(),[[1,0,0],[0,1,0],[-c[0],-c[1],1]],[[b,0,0],[0,b,0],[0,0,1]],[[1,0,0],[0,1,0],[c[0],c[1],1]])):this.matrix(a.geometry.Matrix.multiply(this.matrix(),[[b,0,0],[0,b,0],[0,0,1]]))},applyRotate:function(b,c){var d=(this.x(),this.y(),Math.sin(b)),e=Math.cos(b);c?this.matrix(a.geometry.Matrix.multiply(this.matrix(),[[1,0,0],[0,1,0],[-c[0],-c[1],1]],[[e,d,0],[-d,e,0],[0,0,1]],[[1,0,0],[0,1,0],[c[0],c[1],1]])):this.matrix(a.geometry.Matrix.multiply(this.matrix(),[[e,d,0],[-d,e,0],[0,0,1]]))},applyMatrix:function(){var b=Array.prototype.slice.call(arguments);b=a.array.query({array:b,mapping:function(b){return a.is(b,a.geometry.Matrix)?b.matrix():b}}),b.unshift(this.matrix()),this.matrix(a.geometry.Matrix.multiply.apply(this,b))},_applyTransform:function(a,b){if(this["_"+a]!==b&&!isNaN(b))if(b===this._transform_internal_[a])this["_"+a]=b,this.notify(a);else switch(a){case"x":this.applyTranslate(b-this._transform_internal_.x,0);break;case"y":this.applyTranslate(0,b-this._transform_internal_.y);break;case"scale":this.applyScale(b/this._transform_internal_.scale,[this._transform_internal_.x,this._transform_internal_.y]);break;case"rotate":this.applyRotate(b-this._transform_internal_.rotate,[this._transform_internal_.x,this._transform_internal_.y])}}}})}(nx),function(a){var b=a.define("nx.geometry.Matrix",{mixins:[a.geometry.MatrixSupport],methods:{init:function(c){this.inherited(),this.matrix(c?a.clone(c):b.I)},equal:function(c){return b.equal(this.matrix(),a.is(c,b)?c.matrix():c)}},statics:{I:[[1,0,0],[0,1,0],[0,0,1]],isometric:function(a){return a&&(a[0][0]||a[0][1])&&a[0][0]===a[1][1]&&a[0][1]===-a[1][0]},approximate:function(b,c,d){if(!b||!c||b.length!=c.length)return!1;var e;for(e=0;e<b.length;e++)if(!a.geometry.Vector.approximate(b[e],c[e],d))return!1;return!0},equal:function(b,c){if(!b||!c||b.length!=c.length)return!1;var d;for(d=0;d<b.length;d++)if(!a.geometry.Vector.equal(b[d],c[d]))return!1;return!0},multiply:function(){for(var a,b,c,d,e,f,g,h,i,j,k,l=Array.prototype.slice.call(arguments);l.length>1;){if(a=l[0],b=l[1],a[0].length!=b.length)return null;for(i=a.length,j=b[0].length,k=b.length,c=[],f=0;i>f;f++){for(d=[],g=0;j>g;g++){for(e=0,h=0;k>h;h++)e+=a[f][h]*b[h][g];d.push(e)}c.push(d)}l.splice(0,2,c)}return l[0]},transpose:function(a){var b,c,d=[],e=a.length,f=a[0].length;for(c=0;f>c;c++)for(d[c]=[],b=0;e>b;b++)d[c].push(a[b][c]);return d},cofactor:function(a,b,c){var d=a.map(function(a,d){return d!==b?(a=a.slice(),a.splice(c,1),a):void 0});return d.splice(b,1),d},determinant:function(a){if(1==a.length)return a[0][0];if(2==a.length)return a[0][0]*a[1][1]-a[0][1]*a[1][0];if(3==a.length)return a[0][0]*a[1][1]*a[2][2]+a[0][1]*a[1][2]*a[2][0]+a[0][2]*a[1][0]*a[2][1]-a[0][0]*a[1][2]*a[2][1]-a[0][1]*a[1][0]*a[2][2]-a[0][2]*a[1][1]*a[2][0];var c,d,e,f,g,h=a.map(function(a){return a.slice(1)});for(c=0,d=0,e=h.slice(1),g=1;d<a.length;e.splice(d,1,h[d]),d++,g=-g)if(a[d][0]){var f=b.determinant(e);c+=g*a[d][0]*f}return c},inverse:function(a){var c=b.determinant(a);return c?a.map(function(d,e){return d.map(function(d,f){var g=(e+f)%2?-1:1,h=b.cofactor(a,f,e);return g*b.determinant(h)/c})}):null},getHomogeneousLinearEquationsResults:function(a){var c=b.determinant(a.map(function(a){return a.slice(0,a.length-1)}));return c?a.map(function(d,e){return b.determinant(a.map(function(a){return a=a.slice(),a.splice(e,1,a.pop()),a}))/c}):null},getEstimateGeometricTransformMatrix2D:function(a){var c,d,e,f,g,h=[];for(c=0,d=1,e=2;;)if(f=[a[c],a[d],a[e]],g=b.getHomogeneousLinearEquationsResults([[f[0][0][0],f[0][0][1],1,0,0,0,f[0][1][0]],[0,0,0,f[0][0][0],f[0][0][1],1,f[0][1][1]],[f[1][0][0],f[1][0][1],1,0,0,0,f[1][1][0]],[0,0,0,f[1][0][0],f[1][0][1],1,f[1][1][1]],[f[2][0][0],f[2][0][1],1,0,0,0,f[2][1][0]],[0,0,0,f[2][0][0],f[2][0][1],1,f[2][1][1]]]),g&&h.push(g),++e>a.length-1)if(++d>a.length-2){if(++c>a.length-3)break;d=c+1,e=d+1}else e=d+1;return h.length?(g=h[0].map(function(a,b){var c,d,e;return c=h.map(function(a){return a[b]}),d=c.reduce(function(a,b){return a+b},0)/c.length,e=c.reduce(function(a,b){return a+b*b},0)/c.length-d*d,d}),Array([g[0],g[3],0],[g[1],g[4],0],[g[2],g[5],1])):null}}})}(nx),function(a){var b=a.global,c=b.document,d=navigator.userAgent.toLowerCase(),e=function(){var a,b={windows:/windows|win32/,macintosh:/macintosh|mac_powerpc/,linux:/linux/};for(a in b)if(b[a].test(d))return a;return"other"}(),f=function(){for(var a,b=function(a){var b=new RegExp(a+"(\\d+\\.\\d+)").exec(d);return b?parseFloat(b[1]):0},c=[{tests:[/msie/,/^(?!.*opera)/],name:"ie",version:b("msie "),prefix:"ms",cssPrefix:"-ms-",engine:{name:"trident",version:b("trident\\/")||4}},{tests:[/gecko/,/^(?!.*webkit)/],name:"firefox",version:b("\\bfirefox/"),prefix:"Moz",cssPrefix:"-moz-",engine:{name:"gecko",version:b("rv:")||4}},{tests:[/\bchrome\b/],name:"chrome",version:b("\\bchrome/"),prefix:"webkit",cssPrefix:"-webkit-",engine:{name:"webkit",version:b("webkit\\/")}},{tests:[/safari/,/^(?!.*\bchrome\b)/],name:"safari",version:b("version/"),prefix:"webkit",cssPrefix:"-webkit-",engine:{name:"webkit",version:b("webkit\\/")}},{tests:[/opera/],name:"opera",version:b("version/"),prefix:"O",cssPrefix:"-o-",engine:{name:b("presto\\/")?"presto":"webkit",version:b("presto\\/")||b("webkit\\/")}}];c.length;){for(a=c.shift();a.tests.length&&a.tests[0].test(d);)a.tests.shift();if(!a.tests.length)return delete a.tests,a}return{name:"other",version:0,engine:{name:"unknown",version:0}}}(),g="ie"===f.name&&f.version,h=c.createElement("div"),i=h.style;a.define("nx.env",{statics:{documentMode:c.documentMode||0,compatMode:c.compatMode,strict:"CSS1Compat"===c.compatMode,secure:"https:"===location.protocol.toLowerCase(),userAgent:d,os:e,browser:f,SUPPORT_MAP:{addEventListener:!!c.addEventListener,dispatchEvent:!!c.dispatchEvent,getBoundingClientRect:!!c.documentElement.getBoundingClientRect,onmousewheel:"onmousewheel"in c,XDomainRequest:!!window.XDomainRequest,crossDomain:!(!window.XDomainRequest&&!window.XMLHttpRequest),getComputedStyle:"getComputedStyle"in window,iePropertyChange:!!(g&&9>g),w3cChange:!g||g>8,w3cFocus:!g||g>8,w3cInput:!g||g>9,innerText:"innerText"in h,firstElementChild:"firstElementChild"in h,cssFloat:"cssFloat"in i,opacity:/^0.55$/.test(i.opacity),filter:"filter"in i,classList:!!h.classList,removeProperty:"removeProperty"in i,touch:"ontouchstart"in c.documentElement},KEY_MAP:{BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:"chrome"===f.name||"webkit"===f.name||"safari"===f.name?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145}}})}(nx),nx.ready=function(a){var b,c=new nx.Object;return b=function(){c.release("recursive"),"string"==typeof a&&(a=nx.path(global,a));var b,d;if("function"==typeof a){if(!a.__nx__)return void c.retain("recursive",a(c));b=new a}else b=a;d=nx.path(b,"dom"),d instanceof Node?(document.body.appendChild(d),c.retain("recursive",{release:function(){document.body.removeChild(d),b.release()}})):c=b},"interactive"===document.readyState||"complete"===document.readyState?b():(window.addEventListener("load",b),c.retain("recursive",{release:function(){window.removeEventListener("load",b)}})),c},function(a){a.path(a.global,"nx.util.url",function(){var a=window.location.href,b=window.location.hash,c=a.indexOf("?")>=0&&a.substring(a.indexOf("?")+1);c&&c.indexOf("#")>=0&&(c=c.substring(0,c.indexOf("#")));var d=window.location.protocol,e=window.location.host,f=window.location.hostname,g=window.location.port,h=window.location.pathname;return c&&(c=c.split("&").reduce(function(a,b){var c,d,e=b.indexOf("=");return e>=0?(c=decodeURI(b.substring(0,e)),d=decodeURI(b.substring(e+1))):(c=decodeURI(b),d=!0),a[c]=d,a},{})),b&&(b=b.split("&").reduce(function(a,b){var c,d,e=b.indexOf("=");return e>=0?(c=decodeURI(b.substring(0,e)),d=decodeURI(b.substring(e+1))):(c=decodeURI(b),d=null),a[c]=d,a},{})),{href:a,protocol:d,host:e,hostport:e,hostname:f,port:g,pathname:h,search:c,hash:b}}())}(nx),function(a){var b=a.define("nx.util.fullscreen",{statics:{status:function(){return!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},toggle:function(a){var c=b.status();b.set(!c)},set:function(a){a?document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullscreen&&document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}}})}(nx),function(a){var b=a.env.browser;b.cssPrefix,a.define("nx.util.cssclass",{"static":!0,methods:{has:function(a,b){return a.classList?a.classList.contains(b):(" "+a.className+" ").indexOf(" "+b+" ")>=0},add:function(a,b){return a.classList?(a.classList.add(b),String(a.className)):(this.has(a,b)||(a.className=(a.className||"")+" "+b),String(a.className))},remove:function(a,b){return a.classList?a.classList.remove(b):a.className=String(a.className||"").split(" ").filter(function(a){return a&&a!==b}).join(" ")},toggle:function(a,b,c){return arguments.length>2?c?this.add(a,b):this.remove(a,b):a.classList?a.classList.toggle(b):void(this.has(a,b)?this.remove(a,b):this.add(a,b))}}})}(nx),function(a){var b=a.env.browser,c=b.cssPrefix,d=a.define("nx.util.cssstyle",{"static":!0,methods:{has:function(a,b){var d=a.style.cssText;return 0===d.indexOf(b)||0===d.indexOf(c+b)},get:function(a,b){return a.style[d.camelize(b)]},getBound:function(a){var b=a.getBoundingClientRect();return{left:b.left,top:b.top,width:b.width,height:b.height,right:b.right,bottom:b.bottom}},set:function(b,c,e){if("string"!=typeof c){var f="";return a.each(c,function(a,b){var c=d.stylize(b,a);f+=c.text}),f=b.style.cssText+f,b.style.cssText=f,f}var g=d.stylize(c,e);return b.style.cssText+=g.text,g.value},remove:function(a,b){return a.style.removeProperty(d.camelize(b))},camelize:function(d){var e;switch(d){case"float":e="cssFloat";break;default:0===d.indexOf(c)&&(d=b.prefix+d.substring(c.length-1)),e=a.string.camelize(d)}return e},stylize:function(b,e){b=a.string.uncamelize(b);var f,g,h="";switch(b){case"left":case"right":case"top":case"bottom":case"width":case"height":"number"==typeof e&&(e+="px");break;case"display":"string"!=typeof e?e=e?"":"none":"flex"===e&&(g=c+e);break;case"user-select":case"transform-origin":case"transform-style":case"animation":case"animation-name":case"animation-duration":case"animation-delay":case"animation-iteration-count":case"animation-timing-function":case"animation-fill-mode":case"flex-direction":case"flex-flow":case"flex-wrap":case"justify-content":case"align-content":case"align-items":case"flex":case"order":case"flex-grow":case"flex-shrink":case"flex-basis":case"align-self":f=c+b;break;case"content":e='"'+e+'"';break;case"background-image":g=e.replace(/\S*gradient\(/gi,function(a){return c+a});break;case"transform":f=c+b,a.is(e,Array)&&(3==e.length?e=d.toCssTransformMatrix(e):4===e.length&&(e=d.toCssTransformMatrix3d(e)))}return f?h+=f+":"+(g||e)+";":g&&(h+=b+":"+g+";"),h+=b+":"+e+";",{key:b,prefixKey:f,value:e,prefixValue:g,text:h}},toRgbaArray:function(){var a={aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgrey:[169,169,169,1],darkgreen:[0,100,0,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],grey:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],IndianRed:[205,92,92,1],Indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgrey:[211,211,211,1],lightgreen:[144,238,144,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},b=/rgba\((\d+),\s?(\d+),\s?(\d+),\s?(\d+|\d*\.\d+)\)/,c=/rgb\((\d+),\s?(\d+),\s?(\d+)\)/;return function(d,e){void 0===e&&(e=1);var f,g,h,i;return f=g=h=0,i=1,a[d]?[f,g,h,i]=a[d]:"#"===d.charAt(0)?[f,g,h]=[Number.parseInt(d.substring(1,3),16),Number.parseInt(d.substring(3,5),16),Number.parseInt(d.substring(5,7),16)]:b.test(d)?d.replace(b,function(a,b,c,d,e){[f,g,h,i]=[1*b,1*c,1*d,1*e]}):c.test(d)&&d.replace(c,function(a,b,c,d){[f,g,h]=[1*b,1*c,1*d],i=1}),[f,g,h,i*e]}}(),toMatrixByTransform:function(){var b=/matrix\(.*\)/,c=/\s*,\s*|\s+/;return function(d){var e,f;if(d)return b.test(d)&&(f=d.substring(7,d.length-1).split(c).map(function(a){return 1*a}),e=[[f[0],f[1],0],[f[2],f[3],0],[f[4],f[5],1]]),e||a.geometry.Matrix.I}}(),toCssTransformMatrix:function(a){if(!a)return"none";var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"},toCssTransformMatrix3d:function(a){if(!a)return"none";var b=a.map(function(a){return a.join(",")}).join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix3d("+b+")"},toCssDisplayVisible:function(a){return a?"":"none"}}})}(nx),function(a){var b=a.env.browser.cssPrefix,c=a.util.cssstyle.stylize,d=(a.string.uncamelize,a.string.camelize),e=function(){var b=function(c){if(c.definition){this.definition=c.definition;var e,f,g=b.KEYS;for(this.name=c.name||"keyframes-"+a.uuid(),e=1;e<g.length;e++)f=g[e],this[f]=c[f]||c[d(f)]}else this.definition=c.definition};return b.KEYS=["name","duration","timing-function","delay","iteration-count","direction","fill-mode","play-state"],b.DEFAULTS={duration:"0s","timing-function":"ease",delay:"0s","iteration-count":"infinite",direction:"normal","fill-mode":"none","play-state":"running"},b}(),f={selector:{"::placeholder":{regexp:/::placeholder/g,handler:function(){return"::"+b+"input-placeholder"}},"::scrollbar":{regexp:/::scrollbar/g,handler:function(){return"::"+b+"scrollbar"}},"::scrollbar-track":{regexp:/::scrollbar-track/g,handler:function(){return"::"+b+"scrollbar-track"}},"::scrollbar-thumb":{regexp:/::scrollbar-thumb/g,handler:function(){return"::"+b+"scrollbar-thumb"}}}},g=a.define("nx.util.csssheet",{"static":!0,methods:{create:function(b,c,d){return"string"!=typeof b&&(d=c,c=b,b="jss-"+a.serial()),a.ready(function(){var a,e,f=g.css(c),h=document.getElementsByTagName("head")[0];return e=document.createElement("style"),e.setAttribute("id",b),e.setAttribute("type","text/css"),e.setAttribute("media","screen"),e.setAttribute("rel","stylesheet"),e.appendChild(document.createTextNode(f)),h.appendChild(e),a=d&&d(e,b),{release:function(){a&&a.release(),a=null,e&&h.removeChild(e),e=null}}})},css:function(a){var b,c=[""];for(b in a)c[0]+=g._rule(c,b,a[b]);return c.join("")},keyframes:function(a){return new e(a)},_pair:function(d,f,h){if(0===f.indexOf("nx:"))return g._nxpair(d,f.substring(3),h);if("animation"===f&&h instanceof e){if(h.name||(h.name="keyframes-"+a.uuid()),d.push("@"+b+"keyframes "+h.name+" {"+g.css(h.definition)+"}"),navigator.userAgent.indexOf("Safari/6")>=0)return function(a){var b,d,f,g,h=e.KEYS,i=e.DEFAULTS,j=[];for(b=0;b<h.length;b++)d=h[b],f=a[d]||"number"==typeof a[d]?a[d]:i[d],g=c("animation-"+d,f),j.push(g.text);return j.join("")}(h);h=function(a){var b,c,d=e.KEYS,f=e.DEFAULTS,g=[];for(b=0;b<d.length;b++)c=d[b],a[c]||"number"==typeof a[c]?g.push(a[c]):g.push(f[c]);return g.join(" ")}(h)}var i=c(f,h);return i.text},_nxpair:function(b,c,d){var e;switch(c){case"fixed":case"absolute":"string"==typeof d&&(d=a.string.trim(d).split(/\s*[,\s]\s*/)),e="position:"+c+";",d.length>=4?("auto"!==d[0]&&(e+=g._pair(b,"top",d[0])),"auto"!==d[1]&&(e+=g._pair(b,"right",d[1])),"auto"!==d[2]&&(e+=g._pair(b,"bottom",d[2])),"auto"!==d[3]&&(e+=g._pair(b,"left",d[3]))):3===d.length?("auto"!==d[0]&&(e+=g._pair(b,"top",d[0])),"auto"!==d[1]&&(e+=g._pair(b,"right",d[1])),"auto"!==d[2]&&(e+=g._pair(b,"bottom",d[2])),"auto"!==d[1]&&(e+=g._pair(b,"left",d[1]))):2===d.length?("auto"!==d[0]&&(e+=g._pair(b,"top",d[0])),"auto"!==d[1]&&(e+=g._pair(b,"right",d[1])),"auto"!==d[0]&&(e+=g._pair(b,"bottom",d[0])),"auto"!==d[1]&&(e+=g._pair(b,"left",d[1]))):1===d.length&&d[0]&&("auto"!==d[0]&&(e+=g._pair(b,"top",d[0])),"auto"!==d[0]&&(e+=g._pair(b,"right",d[0])),"auto"!==d[0]&&(e+=g._pair(b,"bottom",d[0])),"auto"!==d[0]&&(e+=g._pair(b,"left",d[0])));break;case"size":"string"==typeof d&&(d=a.string.trim(d).split(/\s*[,\s]\s*/)),e="",d.length>=2?("auto"!==d[0]&&(e+=g._pair(b,"width",d[0])),"auto"!==d[1]&&(e+=g._pair(b,"height",d[1]))):1===d.length&&d[0]&&("auto"!==d[0]&&(e+=g._pair(b,"width",d[0])),"auto"!==d[0]&&(e+=g._pair(b,"height",d[0])))}return e},_rule:function(c,d,h){var i,j,k="";if(h instanceof e)return c.push("@"+b+"keyframes "+d+" {"+g.css(h.definition)+"}"),"";for(i in h)j=h[i],k+=g._pair(c,i,j);return a.each(f.selector,function(a,b){d.indexOf(b)>=0&&(d=d.replace(a.regexp,a.handler))}),d+"{"+k+"}"}}})}(nx),function(a){var b=a.env.browser,c=(b.cssPrefix,a.define("nx.util.event",{statics:{supported:function(a){return a===window?c.EVENTS_WINDOW.slice():c.EVENTS_BASIC.concat(c.EVENTS_TAG[a.tagName.toLowerCase()])},EVENTS_WINDOW:["load","unload","resize"],EVENTS_BASIC:["click","dblclick","contextmenu","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","keydown","keyup","keypress","focus","blur","touchstart","touchmove","touchend","touchcancel"],EVENTS_TAG:{form:["reset","submit"],input:["change","input"],textarea:["change","input"],select:["select"],img:["load","error"]}}}))}(nx),function(a){a.define("nx.util.hash",{"static":!0,properties:{map:function(){return new a.Map}},methods:{init:function(){this.inherited(),window.addEventListener("hashchange",this.onhashchange.bind(this)),this.onhashchange()},getHashString:function(){var a=window.location.hash;return a||(a=window.location.href.indexOf("#"),a=a>=0?window.location.href.substring(a):""),a},getHashMap:function(){return this.toHashMap(this.getHashString())},setHashMap:function(b){var c=[];return a.each(b,function(a,b){"#"===b?c.unshift(a||""):(a||"string"==typeof a)&&c.push(b+"="+a)}),window.location.href="#"+c.join("&")},onhashchange:function(){var b,c,d=this.getHashString();c=this.toHashMap(d),b=this._lastHashMap||{},this.updateMap(b,c),this._lastHashMap=c,this.fire("change",a.global.location.href)},updateMap:function(b,c){var d=this.map(),e=Object.prototype.hasOwnProperty;a.each(b,function(a,b){e.call(c,b)||d.remove(b)}),a.each(c,function(a,b){d.set(b,a)})},toHashMap:function(b){if(!b)return{};var c,d={};return c=b.substring(1).split("&"),-1===c[0].indexOf("=")?d["#"]=c.shift():d["#"]=null,a.each(c,function(a){a=a.split("="),a.length<2&&(a[1]=!0),d[a[0]]=a[1]}),d}}})}(nx),function(a){var b=Object.prototype.hasOwnProperty,c=a.global.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,d=window.cancelAnimationFrame||window.mozCancelAnimationFrame;a.path(a.global,"nx.util.paint",function(b){var e=new a.Object,f=function(){var d=a.date.now();e.release("recursive"),e.retain("recursive",b(d)),g=c(f)},g=c(f);return e.retain({release:function(){d(g),e.release("recursive")}}),e}),a.path(a.global,"nx.util.paint.animate",function(){var c,d,e,f,g;return f=new a.Map,g=new a.List,f.monitor(function(b,c){c.start(a.date.now())}),g.monitorContaining(function(a){var b=a.animation().target();return f.get(b)||f.set(b,a),function(){if(a===f.get(b)){var c=g.find(function(a){return a.animation().target()===b});c?f.set(b,c):f.remove(b)}}}),g.watch("length",function(b,c){c?e=e||a.util.paint(function(){var b=a.date.now();new a.Map;a.each(g,function(a,c){var d;a.start()&&(d=a.getRate(b),a.draw(d)&&(a.stop(b),a.end(b),a.release()))})}):e&&e.release()}),c=a.define({properties:{animation:null,start:0,stop:0,end:0,duration:0,timingFunction:"linear",iterationCount:1,direction:"normal"},methods:{init:function(b){this.inherited(),a.sets(this,b)},getRate:function(b){b=b||a.date.now();var c,d=this.timingFunction()||a.identity;switch(d){case"linear":c=a.identity;break;case"ease":}return Math.max(c((b-this.start())/this.duration()),0)},draw:function(b){b=b>=0?b:this.getRate();var c=this.animation().target(),d=this.animation().state0(),e=this.animation().state1(),f=this.direction(),g=this.iterationCount(),h=!1;return"infinite"===g?b-=Math.floor(b):b>g&&(b=1,h=!0),"alternate"===f&&(b=1-b),a.each(e,function(e,f){var g,h=d[f];"number"==typeof h?a.path(c,f,e*b+h*(1-b)):a.is(h,Array)&&(g=[],a.each(h,function(a,c){g[c]=e[c]*b+h[c]*(1-b)}),a.path(c,f,g))}),h}}}),d=a.define({properties:{target:null,state0:{value:function(){return{}}},state1:{value:function(){return{}}}},methods:{init:function(a){this.inherited(),this.target(a)},reset:function(){var b=this.target(),c=this.state0(),d=this.state1();a.each(d,function(d,e){c[e]=a.path(b,e)})},set:function(c,d){d=d?d+".":"";var e=this.target(),f=this.state0(),g=this.state1();a.each(c,function(c,h){"string"==typeof h&&("number"==typeof c?(b.call(f,d+h)||(f[d+h]=a.path(e,d+h)),g[d+h]=c):a.is(c,Array)?(b.call(f,d+h)||(f[d+h]=a.path(e,d+h)),g[d+h]=c):this.set(c,d+h))}.bind(this))},start:function(b,d,e,f){"number"==typeof b?"alternate"===d||"normal"===d?(f=d,e=1,d="linear"):("string"!=typeof d&&"function"!=typeof d&&(f=e,e=d,d="linear"),"number"!=typeof e&&isNaN(1*e)?(f="alternate"===e?"alternate":"normal",e=1):(e=e||1,f="alternate"===f?"alternate":"normal")):(b=b||{},f="alternate"===b.direction?"alternate":"normal",e=b.iterationCount||1,d=b.timingFunction||"linear",b=b.duration||1e3);var h=new c({animation:this,duration:b,timingFunction:d,iterationCount:e,direction:f});return h.retain({release:function(){h.stop(a.date.now()),g.remove(h)}}),g.push(h),h}}}),function(a,b){var c=new d(a);return b(c),c}}())}(nx),function(){nx.path(nx.global,"nx.util.ajax",function(){var a=nx.global.$?$.ajax:void 0;return function(b){var c=nx.extend({},b),d=new nx.Object;c.success=function(){d.release("abort"),b.success&&nx.func.apply(b.success,this,d,arguments)},c.error=function(){d.release("abort"),b.error&&nx.func.apply(b.error,this,d,arguments)},c.complete=function(){d.release("abort"),b.complete&&nx.func.apply(b.complete,this,d,arguments)};var e=a(c);return d.retain("abort",{release:function(){e.abort()}}),d}}())}(nx),function(a){a.path(a.global,"nx.util.ajaxs",function(){var b=a.util.ajax,c=function(a){var b,c=[];if(a)for(b in a)c.push(b);return c};return function(d){var e,f,g,h,i,j,k=new a.Object,l=d.ajaxs;h={},f=0,i=null,g=c(l),e=g.length;var m=function(){i?(d.error&&d.error(i,j),d.complete&&d.complete()):(d.success&&d.success(h),d.complete&&d.complete()),a.each(g,function(a){k.release(a)})};return a.each(l||{},function(c,d){c=a.extend({},c);var g=c.complete,l=c.success,n=c.error;c.success=function(b){l&&a.func.apply(l,arguments),h[d]=b,f++},c.error=function(b){a.func.apply(n,arguments),i=d,j=b},c.complete=function(){g&&a.func.apply(g,arguments),(i||f>=e)&&m&&m()},k.retain("key",b(c))}),k}}())}(nx),function(a){var b=a.math.square;a.define("nx.ui.capture.MouseProcessor",{properties:{msHold:400,event:{},track:{},handler:{}},methods:{enable:function(a){var b=this;a.addEventListener("mousedown",function(a){b.attach(a)},!0),a.addEventListener("mousemove",function(a){b.move(a)},!0),a.addEventListener("mouseup",function(a){b.end(a)},!0),a.addEventListener("mousedown",function(a){b.detach(a)})},attach:function(a){this.handler(null),this.event(a),a.capture&&(this._lastCapture=a.capture),a.capture=this.capture.bind(this)},detach:function(a){this._lastCapture?(a.capture=this._lastCapture,delete this._lastCapture):delete a.capture},capture:function(a){var b=this.event();if(a&&b&&0===b.button&&!this.handler()){this.handler(a);var c=[];return this.track(c),this.track().push([b.clientX,b.clientY]),this._timer=setTimeout(this.hold.bind(this),this.msHold()),!0}return!1},hold:function(){var a=this.handler(),b=this.event();this.isTrackLong()&&(b.capturedata||(b.capturedata=this._makeDragData(b)),this._call(a,"capturehold",b)),clearTimeout(this._timer)},move:function(a){var b=this.handler();b&&(a.capturedata=this._makeDragData(a),this._call(b,"capturedrag",a))},end:function(a){var b=this.handler();b&&(a.capturedata=this._makeDragData(a),this._call(b,"capturedragend",a),this.isTrackLong()&&this._call(b,"capturetap",a),
this._call(b,"captureend",a)),this.handler(null),this.track(null),this.event(null),clearTimeout(this._timer)},cancel:function(){},isTrackLong:function(){var c=this.track();if(!c)return!1;var d=c[0];return a.each(c,function(a){return b(a[0]-d[0])+b(a[1]-d[1])>9?!1:void 0})},_call:function(b,c,d){if(b[c]&&"function"==typeof b[c]){var e=b[c].call(b);if(e&&"function"==typeof e)return e(d)}else a.is(b,a.ui.Element)&&b.fire(c,d)},_makeDragData:function(a){var b=this.track(),c=[a.clientX,a.clientY],d=b[0],e=b[b.length-1];return c.time=a.timeStamp,b.push(c),d||(d=e=c.slice()),{target:this.handler(),origin:d,position:c,offset:[c[0]-d[0],c[1]-d[1]],delta:[c[0]-e[0],c[1]-e[1]],track:b}}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.Matcher",{properties:{processor:null},methods:{init:function(a){this.inherited(),this.processor(a)},match:function(a){return!1},affect:a.idle}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.ClearMatcher",a.ui.capture.touch.Matcher,{properties:{timer:null},methods:{match:function(a){return 0===a.count()},affect:function(a){var b=this.processor();return b.trigger("captureend",a.lastEvent(),0,function(){b.reset()})}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.TapMatcher",a.ui.capture.touch.Matcher,{methods:{match:function(a){return 0===a.count()&&2===a.timeline().length&&"touchend"===a.timeline()[1].type},affect:function(a){var b=this.processor(),c=a.lastEvent();c.capturedata={position:a.touches()[0].track[0]},b.trigger("capturetap",c)}}})}(nx),function(a){a.geometry.Vector,a.geometry.Math,a.define("nx.ui.capture.touch.HoldMatcher",a.ui.capture.touch.Matcher,{methods:{match:function(a){return 1===a.timeline().length},affect:function(a){var b=this.processor(),c=a.lastEvent();return c.capturedata={position:a.touches()[0].track[0]},b.trigger("capturehold",a.lastEvent(),b.msHold())}}})}(nx),function(a){var b=(a.geometry.Vector,a.geometry.Rectangle,a.geometry.Math,a.define("nx.ui.capture.touch.DragMatcher",a.ui.capture.touch.Matcher,{properties:{touch:null,origin:null,ending:!1},methods:{match:function(a){if(b.isOneTouch(a)){if(this.touch())return!0;var c=b.getTouch(a);return this.touch(c),this.origin(c.track.length-1),!1}return this.touch()?(this.ending(!0),!0):!1},affect:function(a){var b=this.processor(),c=this.ending()?"capturedragend":"capturedrag",d=a.lastEvent();d.capturedata=this.makeZoomData(this.touch().track),b.trigger(c,d),this.ending()&&(this.touch(null),this.ending(!1))},makeZoomData:function(a){var b=a[this.origin()],c=a[a.length-1],d=a[Math.max(this.origin(),a.length-2)];return{position:c.slice(),origin:b.slice(),previous:d.slice(),delta:[c[0]-d[0],c[1]-d[1]],offset:[c[0]-b[0],c[1]-b[1]],track:a.slice(this.origin())}}},statics:{isOneTouch:function(a){return 1===a.count()},getTouch:function(a){var b,c,d=a.touches();for(b=0;b<d.length;b++)if(c=d[b],!c.released)return c},getTrack:function(a){var b,c,d=a.touches();for(b=0;b<d.length;b++)if(c=d[b],!c.released)return c.track}}}))}(nx),function(a){var b=(a.geometry.Vector,a.geometry.Rectangle,a.geometry.Math,a.define("nx.ui.capture.touch.TransformMatcher",a.ui.capture.touch.Matcher,{properties:{origin:null,previous:null},methods:{match:function(a){if(b.isTwoTouch(a)){if(this.origin())return!0;var c=b.getRect(a);return this.origin(c),this.previous(c),!1}return!1},affect:function(a){var c=this.processor(),d=a.lastEvent();return d.capturedata=this.makeZoomData(a),c.trigger("capturetransform",d),this.previous(b.getRect(a)),{release:function(){var a=this.processor().session();b.isTwoTouch(a)||(this.origin(null),this.previous(null))}.bind(this)}},makeZoomData:function(a){var c=this.origin(),d=this.previous(),e=b.getRect(a),f=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2],g=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2],h=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];return{delta:{origin:g,target:h,translate:[h[0]-g[0],h[1]-g[1]],scale:b.distance(e)/b.distance(d),rotate:b.angle(e)/b.angle(d)},offset:{origin:f,target:h,translate:[h[0]-f[0],h[1]-f[1]],scale:b.distance(e)/b.distance(c),rotate:b.angle(e)/b.angle(c)}}}},statics:{isTwoTouch:function(a){return 2===a.count()},getRect:function(b){var c=[];return a.each(b.touches(),function(a){a.released||c.push(a.track[a.track.length-1])}),c},distance:function(a){var b=a[0],c=a[1],d=c[0]-b[0],e=c[1]-b[1];return Math.sqrt(d*d+e*e)},angle:function(a){var b=a[0],c=a[1],d=c[0]-b[0],e=c[1]-b[1];return Math.atan(e,d)}}}))}(nx),function(a){var b=a.geometry.Vector,c=a.geometry.Math,d=a.define("nx.ui.capture.touch.Session",{properties:{precisionTime:200,precisionDelta:5,lastEvent:null,count:0,indices:{value:function(){return{}}},touches:{value:function(){return[]}},timeline:{value:function(){return[]}}},methods:{update:function(a){var b=a.timeStamp,c=!1;d.eachTouch(a,function(d){var e=d.identifier,f=[d.clientX,d.clientY],g=a.type;g="touchcancel"===g?"touchend":g,this[g]&&this[g].call(this,b,e,f)!==!1&&(c=!0)}.bind(this)),c&&(this.lastEvent(a),this.fire("update"))},touchstart:function(a,b,d){var e,f,g=this.indices(),h=this.touches();e=g[b]=h.length,f=h[e]={id:b,index:h.length,track:[d]},this.count(this.count()+1);var i,j=this.timeline();1===j.length&&c.approximate(j[0].time,a,this.precisionTime())?i=j[0]:j.push(i={time:a,type:"touchstart",touches:[]}),i.touches[e]=f},touchmove:function(a,d,e){var f,g,h=this.indices(),i=this.touches();if(f=h[d],g=i[f],b.approximate(g.track[g.track.length-1],e,this.precisionDelta()))return!1;g.track.push(e);var j,k=this.timeline();j=k[k.length-1],"touchmove"===j.type&&c.approximate(j.time,a)||k.push(j={time:a,type:"touchmove",touches:[]}),j.touches[f]=g},touchend:function(a,b){var d,e,f=this.indices(),g=this.touches();d=f[b],e=g[d],f[b]=void 0,e.released=!0,this.count(this.count()-1);var h,i=this.timeline();h=i[i.length-1],"touchend"===h.type&&c.approximate(h.time,a)||i.push(h={time:a,type:"touchend",touches:[]}),h.touches[d]=e}},statics:{eachTouch:function(a,b){var c,d=a.changedTouches.length;for(c=0;d>c&&b(a.changedTouches[c],c)!==!1;c++);}}})}(nx),function(a){a.define("nx.ui.capture.TouchProcessor",{properties:{msDouble:200,msHold:400,event:{},handlers:{},matchers:{value:function(){return[new a.ui.capture.touch.HoldMatcher(this),new a.ui.capture.touch.TapMatcher(this),new a.ui.capture.touch.DragMatcher(this),new a.ui.capture.touch.TransformMatcher(this),new a.ui.capture.touch.ClearMatcher(this)]}},session:{watcher:function(a,b,c){this.release("session"),b&&this.retain("session",b.on("update",this.updateSession.bind(this)))}}},methods:{enable:function(a){var b=this;a.addEventListener("touchstart",function(a){b.attach(a)},!0),a.addEventListener("touchstart",function(a){b.detach(a)}),a.addEventListener("touchmove",function(a){b.update(a)},!0),a.addEventListener("touchend",function(a){b.update(a)},!0),a.addEventListener("touchcancel",function(a){b.update(a)},!0)},attach:function(b){this.event(b),b.capture&&(this._lastCapture=b.capture),b.capture=this.capture.bind(this),this.session()||this.session(new a.ui.capture.touch.Session)},detach:function(a){this._lastCapture?(a.capture=this._lastCapture,delete this._lastCapture):delete a.capture,this.update(a)},capture:function(b,c){var d=this.handlers();d||(d={},this.handlers(d),this.event().preventDefault());var e=!0;return c="string"==typeof c?c.replace(/\s/g,"").split(","):c,a.each(c,function(a){"end"===a?(d.captureend=d.captureend||[],d.captureend.push(b)):(a="capture"+a,b&&!d[a]&&(d[a]=b))}),e},update:function(a){this.session()&&(this.session().update(a),this.handlers()&&a.preventDefault())},reset:function(){this.handlers(null),this.session().release(),this.session(null)},trigger:function(b,c,d,e){return d?a.timer(d,function(){this.triggerAction(b,c),e&&e()}.bind(this)):(this.triggerAction(b,c),void(e&&e()))},triggerAction:function(b,c,d){var e=this,f=this.handlers();"captureend"===b?a.each(f&&f[b],function(a){e.triggerOne(a,b,c)}):f&&f[b]&&e.triggerOne(f[b],b,c)},triggerOne:function(a,b,c){a.fire(b,c)},updateSession:function(){var b=this.session();a.each(this.matchers(),function(a){if(a.release("affect"),a.match(b)){var c=a.affect(b);if(c&&a.retain("affect",c),c===!1)return!1}})}}})}(nx),function(a){var b=a.define("nx.ui.capture.CaptureManager",{properties:{mouseProcessor:{value:function(){return new a.ui.capture.MouseProcessor}},touchProcessor:{value:function(){return new a.ui.capture.TouchProcessor}}},methods:{enable:function(a){a?a.resolve&&(a=a._dom):a=document,this.mouseProcessor().enable(a),this.touchProcessor().enable(a)}},statics:{offsetTooClose:function(a){return Math.abs(a[0])<5&&Math.abs(a[1])<5},fixRect:function(b){return b?(b=a.clone(b),b.width<0&&(b.left+=b.width,b.width=-b.width),b.height<0&&(b.top+=b.height,b.height=-b.height),b):b}}});a.ready(function(){var a=new b;a.enable()})}(nx),function(a){var b=a.global,c=a.Hierarchical,d=a.util.cssclass,e=a.util.cssstyle,f=a.define("nx.ui.Element",a.Hierarchical,{properties:{xmlns:{set:function(){throw new Error("Unable to set xmlns of Element.")}},dom:{set:function(){throw new Error("Unable to set dom of Element.")},watcher:function(b,c){this.release("syncDomEvents"),a.is(c,Element)&&this.retain("syncDomEvents",this._sync_dom_events(c))}},childDefaultType:"nx.ui.Element",hierarchicalSyncDom:a.binding("childList",function(b){this.release("hierarchicalSyncDom"),a.is(b,a.List)&&this.retain("hierarchicalSyncDom",this._sync_child_list(b))})},hierarchical:{capture:function(a,b){return this.hierarchicalUpdateCapture(a,b)},cssclass:function(a,b){return this.hierarchicalUpdateClass(a,b)},cssstyle:function(a,b){return this.hierarchicalUpdateStyles(a,b)},attributes:function(a,b){return this.hierarchicalUpdateAttributes(a,b)}},methods:{init:function(a,b){this.inherited(),this._xmlns=b||"",a instanceof Element?(this._dom=a,this.notify("dom")):(b?this._dom=document.createElementNS(b,a):this._dom=document.createElement(a||"nx-element"),this.notify("dom"),this.initView()),this.fire("ready")},initView:function(){var b,c=this,d=c.constructor,e=[];do b=d.__meta__.view,b&&e.unshift(b),d=d.__super__;while(d&&d!==a.ui.Element);a.each(e,function(a){c.retain(c.hierarchicalUpdate(a,c))})},append:function(a){return this.hierarchicalAppend(a,this)},appendTo:function(c){if(a.is(c,f))return c.append(this);var d=this.dom();return c&&c!==b&&c!==document||(c=document.body),c instanceof Element?(this.parent(c),c.appendChild(d),{release:function(){this.parent(null),c.removeChild(d)}.bind(this)}):void 0},hasAttribute:function(a){return this._dom.hasAttribute(a)},hasAttributeNS:function(a,b){return this._dom.hasAttributeNS(a,b)},getAttribute:function(a){return this._dom.getAttribute(a)},getAttributeNS:function(a,b){return this._dom.getAttributeNS(a,b)},setAttribute:function(a,b){return this._dom.setAttribute(a,b)},setAttributeNS:function(a,b,c){return this._dom.setAttributeNS(a,b,c)},removeAttribute:function(a){return this._dom.removeAttribute(a)},removeAttributeNS:function(a,b){return this._dom.removeAttributeNS(a,b)},hasClass:function(a){return d.has(this._dom,a)},addClass:function(a){return d.add(this._dom,a)},removeClass:function(a){return d.remove(this._dom,a)},toggleClass:function(a,b){return arguments.length>1?d.toggle(this._dom,a,b):d.toggle(this._dom,a)},getComputedStyle:function(a){return this._dom.getComputedStyle(a)},hasStyle:function(a){return this._dom.style.cssText.indexOf(a+":")>=0},getStyle:function(a){return e.get(this._dom,a)},setStyle:function(a,b){return e.set(this._dom,a,b)},removeStyle:function(a){return e.remove(this._dom,a)},getBound:function(){return e.getBound(this._dom)},_sync_dom_events:function(b){var c=this,d=a.util.event.supported(b),e=new a.Object;return a.each(d,function(a){var d=function(b){c.fire(a,b)};e.retain(this.on("+"+a,function(){b.addEventListener(a,d)})),e.retain(this.on("-"+a,function(){b.removeEventListener(a,d)}))},this),a.each(d,function(a){var d=function(b){c.fire(":"+a,b)};e.retain(this.on("+:"+a,function(){b.addEventListener(a,d,!0)})),e.retain(this.on("-:"+a,function(){b.removeEventListener(a,d,!0)}))},this),e},_sync_child_list:function(a){return a.monitorDiff(function(a){var b,c,d,e,f,g,h,i,j=a.diffs,k=a.drops,l=a.joins,m=this._dom;for(b=0;b<j.length;b++)switch(d=j[b],e=k[b],g=l[b],d[0]){case"splice":for(c=0;c<e.length;c++)h=e[c],h&&(i=h instanceof Node?h:h._dom,i instanceof Node&&m.removeChild(i));for(f=m.childNodes[d[1]],c=0;c<g.length;c++)h=g[c],h&&(i=h instanceof Node?h:h._dom,i instanceof Node&&(f?m.insertBefore(i,f):m.appendChild(i)));break;case"move":if(d[3]>0)for(f=m.childNodes[d[1]+d[2]+d[3]],c=d[2]-1;c>=0;c--)i=m.childNodes[d[1]+c],f?m.insertBefore(i,f):m.appendChild(i),f=i;else for(f=m.childNodes[d[1]+d[3]]||m.firstChild,c=d[2]-1;c>=0;c--)i=m.childNodes[d[1]+c],f?m.insertBefore(i,f):m.appendChild(i),f=i}},this)},hierarchicalAppend:function(a,b,c){return a instanceof Node?this.hierarchicalAppendChildren([a],b,c):this.inherited(a,b,c)},hierarchicalAppendString:function(b,c,d){var e=this.inherited(b,c,d);return e===a.Object.IDLE_RESOURCE?this.hierarchicalAppendHtml(b,c,d):e},hierarchicalAppendNumber:function(a,b,c){return this.hierarchicalAppendHtml(a,b,c)},hierarchicalAppendHtml:function(a,b,c){var d=this;b=b||d;var e=document.createElement("div");e.innerHTML=a;var f=Array.prototype.slice.call(e.childNodes);return d.hierarchicalAppendChildren(f,b,c)},hierarchicalUpdateEvent:function(a,b,c){return"capture"===a?this.hierarchicalUpdateCapture(b,c):this.inherited(a,b,c)},hierarchicalUpdateCapture:function(b,d){var e=this,f=new a.Object;if(b=c.getBindingIfString(b)||b,a.is(b,a.binding))f.retain(a.Object.binding(d,b,function(a){f.release("recursive"),f.retain("recursive",e.hierarchicalUpdateCapture(a,d))}));else if(a.is(b,a.Object))f.retain(this.hierarchicalUpdateCaptureObject(b,d));else{var g,h=[];a.each(b,function(a,b){"start"===b?g=a:(h.push(b),b=b.split(" ").map(function(a){return"capture"+a}).join(" "),f.retain(e.hierarchicalUpdateEvent(b,a,d)))}),h.length&&(h=h.join(" ").split(" "),f.retain(e.hierarchicalUpdateEvent("mousedown touchstart",function(b,c){if(c.capture(b,h),g)if("string"==typeof g){for(;"{"===g.charAt(0)&&"}"===g.charAt(g.length-1);)g=g.substring(1,g.length-1);a.path(d,g).call(d,b,c)}else g.call(d,b,c)},d)))}return f},hierarchicalUpdateCaptureObject:function(b,c){var d=this,e=new a.Object,g=new a.List;return a.each(f.CAPTURES,function(a){var f=b[a];f&&"function"==typeof f&&("property"===f.__type__?e.retain(a+"-watch",b.watch(a,function(a,f){"function"==typeof f?(e.retain(a,d.hierarchicalUpdateEvent("capture"+a,f.bind(b),c)),g.toggle(a,!0)):(e.release(a),g.toggle(a,!1))})):(e.retain(a,d.hierarchicalUpdateEvent("capture"+a,f.bind(b),c)),g.toggle(a,!0)))}),e.retain(g.watch("length",function(f,h){h?e.retain("start",d.hierarchicalUpdateEvent("mousedown touchstart",function(d,e){e.capture(d,g.toArray());var f=a.path(b,"start");f&&f.call(c,d,e)},c)):e.release("start")})),e},hierarchicalUpdateAttributes:function(b,c){var d=this,e=new a.Object;return a.each(b,function(a,b){"class"===b?e.retain(d.hierarchicalUpdateClass(a,c)):"style"===b?e.retain(d.hierarchicalUpdateStyles(a,c)):e.retain(d.hierarchicalUpdateAttribute(b,a,c))}),e},hierarchicalUpdateAttribute:function(b,d,e){var f=this;if(e=e||f,d=c.getBindingIfString(d)||d,a.is(d,a.binding)){var g=new a.Object;return g.retain(a.Object.binding(e,d,function(a){g.release("recursive"),g.retain("recursive",f.hierarchicalUpdateAttribute(b,a,e))})),g}return d||0===d||""===d?f.setAttribute(b,d):f.removeAttribute(b),a.Object.IDLE_RESOURCE},hierarchicalUpdateClass:function(b,d){var e=this;if(d=d||e,a.is(b,a.binding))return e.hierarchicalUpdateClassBinding(b,d);var f=new a.Object;return a.is(b,"String")?a.each(b.split(" "),function(a){var b=c.getStringBindingByString(a);b?f.retain(e.hierarchicalUpdateClassBinding(b,d)):f.retain(e.hierarchicalUpdateClassValue(a,d))}):a.is(b,"Array")&&a.each(b,function(a){f.retain(e.hierarchicalUpdateClass(a,d))}),f},hierarchicalUpdateClassValue:function(a,b){var c=this;return b=b||c,a&&c.addClass(a),{release:function(){a&&c.removeClass(a),a=null}}},hierarchicalUpdateClassBinding:function(b,c){var d=this;c=c||d;var e=(d.dom(),new a.Object);return e.retain(a.Object.binding(c,b,function(a){e.release("recursive"),a&&e.retain("recursive",d.hierarchicalUpdateClass(a,c))})),e},hierarchicalUpdateStyles:function(b,d){var e=this;b=c.getBindingIfString(b)||b;var f;return a.is(b,a.binding)?(f=new a.Object,f.retain(a.Object.binding(d,b,function(a){f.release("recursive"),a&&f.retain("recursive",e.hierarchicalUpdateStyles(a,d))}))):"string"==typeof b?f=a.Object.IDLE_RESOURCE:(f=new a.Object,a.each(b,function(a,b){f.retain(e.hierarchicalUpdateStyle(b,a,d))})),f},hierarchicalUpdateStyle:function(b,d,e){var f=this;return e=e||f,d=c.getBindingIfString(d)||d,a.is(d,a.binding)?f.hierarchicalUpdateStyleBinding(b,d,e):f.hierarchicalUpdateStyleValue(b,d,e)},hierarchicalUpdateStyleValue:function(a,b,c){var d=this;c=c||d;var e=d.hasStyle(a)?d.getStyle(a):null;return d.setStyle(a,b),{release:function(){e?d.setStyle(a,e):d.removeStyle(a)}}},hierarchicalUpdateStyleBinding:function(b,c,d){var e=this;d=d||e;var f=new a.Object;return f.retain(a.Object.binding(d,c,function(a){f.release("recursive"),f.retain("recursive",e.hierarchicalUpdateStyle(b,a,d))})),f}},statics:{CAPTURES:["tap","dragstart","drag","dragend","transform","hold","end"],CSS:a.util.csssheet.create({"nx-element":{display:"block"}})}})}(nx),function(a){var b=a.ui.Element;a.define("nx.ui.Template",{properties:{parent:{},list:{},template:{},context:{}},methods:{init:function(b,c,d,e){this.inherited(),this.parent(b),this.list(c),this.template(d),this.context(e),this.retain(a.Object.cascade(this,"parent,list,template,context",function(a,b,c,d){b&&(this.release("target-list"),this.retain("target-list",b.monitorContaining(function(a){return function(){a.release()}}))),a&&b&&c&&(d=d||a,this.retain("initial",this.applyBinding(a,b,c.binding,c.pattern,d)))}))},applyBinding:function(b,c,d,e,f){var g=this,h=new a.Object;return h.retain(a.Object.binding(f,d,function(i){h.release("recursive"),a.is(i,a.binding)?h.retain("recursive",g.applyTemplate(b,c,d,e,f)):a.is(i,a.List)?h.retain("recursive",g.applyList(b,c,i,e,f)):a.is(i,"Array")&&h.retain("recursive",g.applyList(b,c,new a.List(i),e,f))})),h},applyList:function(c,d,e,f,g){g=g||c;var h=a.List.mapeach(e,"model",{count:"list.length",parent:function(){return c},list:function(){return d},context:function(){return g},views:a.binding("parent, context, list, model",function(c,d,e,g){if(c&&d&&e){var h=this;this.release("views");var i=new a.Object;return this.retain("views",i),f.map(function(a){var d=b.create(c,a);return b.extendProperty(d,"scope",h),d.retain(b.update(d,a,d)),i.retain(d),d})}})});return h.retain(h.monitorDiff(function(b){var c=[];a.each(b.diffs,function(a){var b=a.slice();switch(b[0]){case"splice":b[1]*=f.length,b[2]*=f.length,b[3]=b[3].reduce(function(a,b){return a.concat(b.views())},[]);break;case"move":b[1]*=f.length,b[2]*=f.length,b[3]*=f.length}c.push(b)}),d.differ(c)})),h}}})}(nx),function(a){a.define("nx.ui.tag.Image",a.ui.Element,{methods:{init:function(){this.inherited("img")}},statics:{load:function(b,c){var d=new a.Object,e=document.createElement("img");return e.onload=function(){c&&c({success:!0,image:e,size:{width:e.width,height:e.height}})},e.onerror=function(){c&&c({success:!1,image:e})},e.src=b,d.retain({release:function(){e=c=null}}),d}}})}(nx),function(a){a.define("nx.ui.tag.Form",a.ui.Element,{methods:{init:function(){this.inherited("form")}}})}(nx),function(a){a.define("nx.ui.tag.Label",a.ui.Element,{methods:{init:function(){this.inherited("label")}}})}(nx),function(a){a.define("nx.ui.tag.HyperLink",a.ui.Element,{methods:{init:function(){this.inherited("a")}}})}(nx),function(a){a.define("nx.ui.tag.Select",a.ui.Element,{methods:{init:function(){this.inherited("select")},focus:function(){return this.dom().focus()},blur:function(){return this.dom().blur()}}})}(nx),function(a){a.define("nx.ui.tag.SelectOption",a.ui.Element,{methods:{init:function(){this.inherited("option")}}})}(nx),function(a){a.define("nx.ui.tag.Input",a.ui.Element,{methods:{init:function(){this.inherited("input")},focus:function(){return this.dom().focus()},blur:function(){return this.dom().blur()}}})}(nx),function(a){a.define("nx.ui.tag.InputFile",a.ui.tag.Input,{view:{attributes:{type:"file"},events:{change:function(a,b){this.value(this.dom().value)}}},properties:{value:""}})}(nx),function(a){a.define("nx.ui.tag.InputCheckBox",a.ui.tag.Input,{view:{attributes:{type:"checkbox"}}})}(nx),function(a){a.define("nx.ui.tag.InputRadio",a.ui.tag.Input,{view:{attributes:{type:"radio"}}})}(nx),function(a){a.define("nx.ui.tag.InputButton",a.ui.tag.Input,{view:{attributes:{type:"button"}}})}(nx),function(a){a.define("nx.ui.tag.InputHidden",a.ui.tag.Input,{view:{attributes:{type:"hidden"}}})}(nx),function(a){a.define("nx.ui.tag.TextArea",a.ui.Element,{methods:{init:function(){this.inherited("textarea")}}})}(nx),function(a){a.define("nx.ui.tag.TableHeadCell",a.ui.Element,{methods:{init:function(){this.inherited("th")}}})}(nx),function(a){a.define("nx.ui.tag.TableCell",a.ui.Element,{methods:{init:function(){this.inherited("td")}}})}(nx),function(a){a.define("nx.ui.tag.TableRow",a.ui.Element,{methods:{init:function(){this.inherited("tr")}},properties:{childDefaultType:{value:function(){return a.ui.tag.TableCell}}}})}(nx),function(a){a.define("nx.ui.tag.Table",a.ui.Element,{methods:{init:function(){this.inherited("table")}},properties:{childDefaultType:{value:function(){return a.ui.tag.TableRow}}}})}(nx),function(a){a.define("nx.ui.tag.Span",a.ui.Element,{methods:{init:function(){this.inherited("span")}}})}(nx),function(a){a.define("nx.ui.tag.Canvas",a.ui.Element,{methods:{init:function(){this.inherited("canvas")}}})}(nx),function(a){a.define("nx.ui.tag.Source",a.ui.Element,{methods:{init:function(){this.inherited("source")}}})}(nx),function(a){a.define("nx.ui.tag.Audio",a.ui.Element,{view:{content:{repeat:"sources",type:"nx.ui.tag.Source",attributes:{src:a.binding("scope.model.src"),type:a.binding("scope.model.type")}}},properties:{sources:{}},methods:{init:function(){this.inherited("audio")},play:function(){this.dom().play()},pause:function(){this.dom().pause()}}})}(nx),function(a){a.define("nx.ui.tag.Video",a.ui.Element,{methods:{init:function(){this.inherited("video")},play:function(){this.dom().play()},pause:function(){this.dom().pause()}}})}(nx),function(a){a.define("nx.ui.tag.HorizontalRule",a.ui.Element,{methods:{init:function(){this.inherited("hr")}}})}(nx),function(a){var b=a.define("nx.lib.DefaultApplication",a.ui.Element,{properties:{size:{watcher:function(b,c){this.release("size"),c&&this.retain("size",a.ready(function(){var b=this.getGlobalFontSizeByPageSize(c);b?(a.util.cssstyle.set(document.documentElement,"font-size",b+"px"),this.setStyle("font-size",b+"px")):(a.util.cssstyle.remove(document.documentElement,"font-size"),this.removeStyle("font-size"))}.bind(this)))}}},methods:{init:function(){this.inherited("nx-app"),this.retain(this.syncViewScale()),b.CSS_GLOBAL||(b.CSS_GLOBAL=a.util.csssheet.create({html:{height:"100%"},body:{margin:"0",padding:"0",height:"100%",color:"#b3b3b3","font-family":"'Roboto'","user-select":"none"}}))},syncViewScale:function(){var a=this,b=function(b){a.size({width:global.innerWidth,height:global.innerHeight})};return global.addEventListener("resize",b),this.size({width:global.innerWidth,height:global.innerHeight}),{release:function(){global.removeEventListener("resize",b)}}},getGlobalFontSizeByPageSize:function(a){return 0}}})}(nx),function(a){a.define("nx.lib.thread.Thread",{properties:{worker:null},methods:{init:function(a){this.inherited();var b=this.worker(new Worker(a));b.onmessage=function(a){this.fire("message",a.data)}.bind(this)},send:function(a){this.worker().postMessage(a)}}})}(nx),function(a){a.define("nx.lib.svg.AbstractNode",a.ui.Element,{properties:{childDefaultType:{value:function(){return a.lib.svg.Node}},graph:null,fill:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("fill",b):this.removeStyle("fill")}},fillComputed:{dependencies:"fill,parentNode.strokeComputed",value:function(a,b){return a&&"inherit"!=a?a:b||"black"}},stroke:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("stroke",b):this.removeStyle("stroke")}},strokeComputed:{dependencies:"stroke,parentNode.strokeComputed",value:function(a,b){return a&&"inherit"!=a?a:b||"black"}},strokeWidth:{value:"inherit",watcher:function(a,b){b&&"inherit"!=b?this.setStyle("stroke-width",b):this.removeStyle("stroke-width")}},strokeWidthComputed:{dependencies:"strokeWidth,parentNode.strokeWidthComputed",value:function(a,b){return a>=0?a:b||0}}},methods:{hierarchy:function(){for(var a=[this],b=this.parentNode();b;)a.unshift(b),b=b.parentNode();return a}},statics:{cssTransformMatrix:function(a){if(!a)return"";var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"}}})}(nx),function(a){a.define("nx.lib.svg.SvgDefs",a.lib.svg.AbstractNode,{methods:{init:function(){this.inherited("defs",a.lib.svg.Svg.DEFAULT_XML_NAMESPACE)}},properties:{graph:{dependencies:"parentNode.graph"}}})}(nx),function(a){a.define("nx.lib.svg.SvgStyle",a.lib.svg.AbstractNode,{methods:{init:function(){this.inherited("style",a.lib.svg.Svg.DEFAULT_XML_NAMESPACE)}},properties:{graph:{dependencies:"parentNode.graph"}}})}(nx),function(a){var b=a.define("nx.lib.svg.Svg",a.lib.svg.AbstractNode,{view:{content:{name:"defs",type:"nx.lib.svg.SvgDefs"}},properties:{graph:{value:function(){return this}},naturalTerminal:{value:!1}},methods:{init:function(){this.inherited("svg","http://www.w3.org/2000/svg")},getWidth:function(){return this.$dom.offsetWidth},getHeight:function(){return this.$dom.offsetHeight},serialize:function(a){return b.serialize(this.dom(),a)}},statics:{DEFAULT_XML_NAMESPACE:"http://www.w3.org/2000/svg",getSvgSize:function(a){var b=a.getAttribute("width"),c=a.getAttribute("height"),d=a.getAttribute("viewBox");return b&&(b=1*b.replace(/[^-.0123456789]/g,"")),c&&(c=1*c.replace(/[^-.0123456789]/g,"")),d&&(d=d.split(" "),b=b||1*d[2]||0,c=c||1*d[3]||0),{width:b||0,height:c||0}},serialize:function(a,b){var c=new XMLSerializer,d=c.serializeToString(a);return b!==!1?"data:image/svg+xml;utf8,"+d:d}}});a.util.csssheet.create({"svg text":{"user-select":"none"}})}(nx),function(a){var b=a.geometry,c=a.define("nx.lib.svg.Node",a.lib.svg.AbstractNode,{mixins:[a.geometry.MatrixSupport],properties:{graph:{dependencies:"parentNode.graph"},cssTransform:{dependencies:"matrix",value:function(a){return a?c.cssTransformMatrix(a):void 0},watcher:function(a,b){b&&("matrix(1,0,0,1,0,0)"!=b||this.hasStyle("transform"))&&this.setStyle("transform",b)}},naturalTerminal:{value:!1},naturalMatrix:{dependencies:"parentNode.naturalTerminal, parentNode.naturalMatrix, matrix",value:function(a,c,d,e){a&&0==e.indexOf("parentNode.")||(c&&d?this.naturalMatrix(b.Matrix.multiply(d,c)):d&&this.naturalMatrix(d||c||b.Matrix.I))}},naturalMatrix_internal_:{dependencies:"naturalMatrix",value:function(a){return a&&new b.Matrix(a)}},naturalPosition:{dependencies:"naturalMatrix",value:function(a){return a&&[a[2][0],a[2][1]]||[0,0]}},naturalRotate:{dependencies:"naturalMatrix_internal_.rotate"},naturalScale:{dependencies:"naturalMatrix_internal_.scale"}},methods:{init:function(b){this.inherited(b||"g",a.lib.svg.Svg.DEFAULT_XML_NAMESPACE)},applyNatureTranslate:function(a,c){var d=(this.parentNode(),[[1,0,0],[0,1,0],[a,c,1]]);this.matrix(b.Matrix.multiply(this.naturalMatrix_internal_().getMatrixInversion(),d,this.naturalMatrix(),this.matrix()))}},statics:{cssTransformMatrix:function(a){var b=[a[0][0],a[0][1],a[1][0],a[1][1],a[2][0],a[2][1]].join(",").replace(/-?\d+e[+-]?\d+/g,"0");return"matrix("+b+")"}}})}(nx),function(a){a.define("nx.lib.svg.Use",a.lib.svg.Node,{properties:{href:{watcher:function(a,b){b&&this.setAttributeNS("http://www.w3.org/1999/xlink","href",b)}}},methods:{init:function(){this.inherited("use")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Image",a.lib.svg.Node,{properties:{href:{watcher:function(a,b){b&&this.setAttributeNS("http://www.w3.org/1999/xlink","href",b)}}},methods:{init:function(a){this.inherited("image")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Text",a.lib.svg.Node,{methods:{init:function(){this.inherited("text")}},view:{properties:{"class":"text"}},properties:{text:{value:"",watcher:function(a,b){this.release("text"),this.retain("text",this.append(b))}},textAnchor:{value:"middle",watcher:function(a,b){this.setAttribute("text-anchor",b)}}},statics:{CSS:a.util.csssheet.create({"svg text":{stroke:"none"}})}})}(nx),function(a){a.define("nx.lib.svg.shape.Line",a.lib.svg.Node,{methods:{init:function(){this.inherited("line")}}})}(nx),function(a){a.define("nx.lib.svg.shape.LineAsVector",a.lib.svg.Node,{view:{attributes:{x1:"0",y1:"0"}},properties:{dx:{value:0,watcher:function(a,b){b||0===b||(b=""),this.setAttribute("x2",b)}},dy:{value:0,watcher:function(a,b){b||0===b||(b=""),this.setAttribute("y2",b)}}},methods:{init:function(){this.inherited("line")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Rectangle",a.lib.svg.Node,{properties:{center:{value:!1},width:{value:0},height:{value:0},bound_internal_:{dependencies:"center, width, height",value:function(a,b,c){var d,e,f,g;return f=Math.abs(b),g=Math.abs(c),a?(d=-f/2,e=-g/2):(d=0>b?b:0,e=0>c?c:0),[d,e,f,g]},watcher:function(b,c){c&&a.each(["x","y","width","height"],function(a,b){c[b]?this.setAttribute(a,c[b]):this.removeAttribute(a)}.bind(this))}},rx:{value:0,watcher:function(a,b){b?this.setAttribute("rx",b):this.removeAttribute("rx")}},ry:{value:0,watcher:function(a,b){b?this.setAttribute("ry",b):this.removeAttribute("ry")}}},methods:{init:function(){this.inherited("rect")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Polygon",a.lib.svg.Node,{methods:{init:function(){this.inherited("polygon")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Circle",a.lib.svg.Node,{methods:{init:function(){this.inherited("circle")}}})}(nx),function(a){a.define("nx.lib.svg.shape.Path",a.lib.svg.Node,{methods:{init:function(){this.inherited("path")}},properties:{vectors:{value:[]},d:{dependencies:"vectors",value:function(a){if(a&&a.length){var b="M 0 0";do v=a.shift(),b+=" l "+v[0]+" "+v[1];while(a.length);return b}return this._d||"M 0 0"},watcher:function(a,b){this.setAttribute("d",b)}}}})}(nx),function(a){a.define("nx.lib.svg.shape.PathGroup",a.lib.svg.Node,{view:{content:a.template({source:"data",pattern:{type:"nx.lib.svg.shape.Path",properties:{d:a.binding("scope.model.d"),fill:a.binding("scope.model.fill"),stroke:a.binding("scope.model.stroke")}}})},properties:{data:{}}})}(nx),function(a){var b=a.geometry.Vector,c=b.multiply,d=b.rotate,e=b.abs,f=b.plus,g=Math.sqrt(5)/2-.5;a.define("nx.lib.svg.shape.PathLine",a.lib.svg.shape.Path,{properties:{operationsUpdater_internal_:{dependencies:"dx, dy, dh",async:!0,value:function(a,b,h,i){if(i){var j=[b,h],k=d(e([b,h],i),Math.PI/2),l=f(c(j,.5),k),m="M 0 0";m+=" "+["C"].concat(f(c(k,g),c(j,1/6))).concat(f(k,c(j,1/3))).concat(l).join(" "),m+=" "+["C"].concat(f(k,c(j,2/3))).concat(f(c(k,g),c(j,5/6))).concat(j).join(" "),this.d(m)}else this.vectors([[b,h]])}},dx:{value:100},dy:{value:0},dh:{value:0}}})}(nx),function(a){var b=a.geometry,c=b.Vector,d=c.rotate,e=c.abs,f=c.multiply,g=(c.plus,function(a,b,c){return a=f(a,b),c&&(a=d(a,c)),a}),h=Math.PI,i=(Math.abs,b.Math.sin),j=(b.Math.cos,b.Math.tan),k=b.Math.cot,l=h/2;a.define("nx.lib.svg.shape.Arrow",a.lib.svg.shape.PathLine,{view:{cssclass:"arrow"},properties:{stroke:{watcher:function(a,b){b&&"inherit"!=b&&this.setAttribute("fill",b)}},strokeWidth:{value:"inherit",watcher:a.idle},fill:{watcher:a.idle},operationsUpdater_internal_:{dependencies:"strokeWidthComputed,dx,dy,dh,sharpness,concavity",async:!0,value:function(b,c,d,f,m,n,o){var p=[c,d,f,m,n,o].findIndex(function(b){return!a.is(b,"Number")})<0;if(p&&0!=c&&(0!=d||0!=f)){var q=[];
o=o||h;var r=[d,f],s=e(r,1),t=e(r),u=c,v=n/2,w=o/2,x=u/2,y=t-x*(2*k(v)-k(w));n>0&&h>=n&&4*x/t<j(v)?(q.push(g(s,x,l)),q.push(g(s,y)),q.push(g(s,x/i(w),h-w)),q.push(g(s,u/i(v),-v)),q.push(g(s,u/i(v),h+v)),q.push(g(s,x/i(w),w)),q.push(g(s,-y)),q.push(g(s,x,l))):(q.push(g(s,x,l)),q.push([d,f]),q.push(g(s,2*x,-l)),q.push([-d,-f]),q.push(g(s,x,l))),this.vectors(q)}}},sharpnessDeg:{value:30},sharpness:{dependencies:"sharpnessDeg",value:function(a){return a?a*h/180:h/6}},concavityDeg:{value:0},concavity:{dependencies:"concavityDeg",value:function(a){return a?a*h/180:h}}},methods:{init:function(a){this.inherited(a),this.setAttribute("stroke-width",0)}}})}(nx),function(a){a.define("nx.lib.svg.filter.Filter",a.lib.svg.AbstractNode,{properties:{graph:{dependencies:"parentNode.graph"}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeBlend",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feBlend","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeColorMatrix",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feColorMatrix","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeComponentTransfer",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feComponentTransfer","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeComposite",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feComposite","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeConvolveMatrix",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feConvolveMatrix","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDiffuseLighting",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDiffuseLighting","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDisplacementMap",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDisplacementMap","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeDistantLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feDistantLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeFlood",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feFlood","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeGaussianBlur",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feGaussianBlur","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeImage",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feImage","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeMerge",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feMerge","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeMorphology",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feMorphology","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeOffset",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feOffset","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FePointLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("fePointLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeSpecularLighting",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feSpecularLighting","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeSpotLight",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feSpotLight","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeTile",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feTile","http://www.w3.org/2000/svg")}}})}(nx),function(a){a.define("nx.lib.svg.filter.FeTurbulence",a.lib.svg.filter.Filter,{methods:{init:function(){this.inherited("feTurbulence","http://www.w3.org/2000/svg")}}})}(nx),function(a){var b=2,c="y",d=a.define("nx.lib.component.Scroller",a.ui.Element,{view:{cssclass:"scroller",content:{name:"inner"},capture:{start:"handler_dragstart",drag:"handler_dragmove",dragend:"handler_dragend"},events:{axis:"option_axis"}},properties:{pageSize:1,axis:c,elastic:2e3},methods:{init:function(b){this.inherited(),a.sets(this,b),this._x=this._y=0},isScrollable:function(a){var b=this.axis()||c;return 0==arguments.length?"x"==b||"y"==b:a==b},getLimit:function(){var a,b=this.axis(),c=0;return c=Math.min(0,this._out[b]-this._in[b]),a=this.pageSize(),c&&a>1&&(c=Math.ceil(c/a)*a),c},delta:function(a){if(!this.isScrollable())return 0;var c=this.axis(),d=this.getLimit(c),e=this["_"+c];return e>0?e*b+a>0?a/b:d>2*e+a?(a-d)/b+d:e*b+a-e:0>e-d?0>(e-d)*b+a?a/b:(e-d)*b+a>-d?(a+d)/b-d:a-(b-1)*(d-e):e+a>0?(a-e)/2:d>e+a?(a-e+d)/2:a},freemove:function(a){if(!this.isScrollable())return!1;var c,d,e,f,g,h,i,j,k,l,m,n,o=this.axis(),p=this;c=this.elastic(),d=this.getLimit(),e=this["_"+o],e>0||d>e?(f=e>0?-e:d-e,g=Math.sqrt(Math.abs(2*f/c/b)),h="(0.5, 1, 1, 1)"):(g=Math.abs(a/c),f=a*g/2,i=e+f,0>=i&&i>=d?h="(0, 1, 1, 1)":(f=i>0?-e:d-e,j=(a>=0?1:-1)*Math.sqrt(a*a-2*c*f),k=Math.abs((a-j)/c),l=Math.abs(j/b/c),g=k+2*l,m=j*l/2,n=f+2*m,h="("+(k+l)/g+","+n/f+","+(k+1.5*l)/g+", 1)")),g>1&&(g=1),this.animate(g,h),this["_"+o]+=f,this.translate(this._x,this._y),setTimeout(function(){var a=p.pageSize()||1,b=p["_"+o];b%a?(p["_"+o]=Math.round(b/a)*a,p.animate(.15,"(0.5, 1, 1, 1)"),p.translate(p._x,p._y),setTimeout(function(){p.animate(!1)},150)):p.animate(!1)},1e3*g+10)},option_axis:function(){this.reset()},update:function(){var a=this.inner().getBound(),b=this.getBound();this._in={x:a.width,y:a.height},this._out={x:b.width,y:b.height}},reset:function(){this._x=0,this._y=0,this.translate(this._x,this._y)},fixbound:function(){this.update(),this.freemove(0)},handler_dragstart:function(a,b){this.update(),this.animate(!1)},handler_dragmove:function(a,b){if(this.isScrollable()){var c=this.axis();this["_"+c]+=this.delta(b.capturedata.delta["x"==c?0:1]),this.translate(this._x,this._y)}},handler_dragend:function(a,b){if(this.isScrollable()){var c=d.getSpeed(b.capturedata.track),e=this.axis();this.freemove(c[e])}},translate:function(a,b){this.inner().setStyle("transform","translate("+a+"px, "+b+"px)"),this.inner().setStyle("transform","translate3d("+a+"px, "+b+"px, 0)")},animate:function(a,b){if(a===!1)this.inner().removeStyle("transition-duration"),this.inner().removeStyle("transition-timing-function");else{var c=a+"s";this.inner().setStyle({"transition-duration":c,"transition-timing-function":"cubic-bezier"+b})}}},statics:{DEFAULT_AXIS:c,getSpeed:function(a){var b={x:1e3*(a[a.length-1][0]-a[0][0])/Math.max(1,a[a.length-1].time-a[0].time),y:1e3*(a[a.length-1][1]-a[0][1])/Math.max(1,a[a.length-1].time-a[0].time)};return Math.abs(a[a.length-1][0]-a[0][0])<40?b.x=0:Math.abs(b.x)<1200&&(b.x=1200*(b.x>0?1:-1)),Math.abs(a[a.length-1][1]-a[0][1])<40?b.y=0:Math.abs(b.y)<1200&&(b.y=1200*(b.y>0?1:-1)),a[a.length-1].time-a[0].time>300&&(b.x=b.y=0),b}}})}(nx),function(a){a.define("nx.lib.component.FileLabel",a.ui.tag.Label,{view:{attributes:{"for":a.binding("name"),"class":["nx-file-label",a.binding("disabled",function(a){return a?"disabled":!1})]},content:[{name:"input",type:"nx.ui.tag.InputFile",attributes:{id:a.binding("name"),name:a.binding("name"),accept:a.binding("accept"),disabled:a.binding("disabled",function(a){return a?"disabled":!1})},events:{change:function(){this.fire("change",this.input().dom())}}}]},properties:{name:"",accept:"",disabled:!1}})}(nx),function(a){a.define("nx.lib.component.NormalInput",a.ui.Element,{view:{cssclass:"nx-normal-input",content:{name:"input",type:"nx.ui.tag.Input",attributes:{value:a.binding("value",!0,function(a,b){b!==this.input().dom().value&&(this.input().dom().value=b)}),id:a.binding("id"),name:a.binding("name"),placeholder:a.binding("placeholder"),readonly:a.binding("readonly"),type:a.binding("password",function(a){return a?"password":"text"})},events:{input:function(a,b){this.value(this.input().dom().value),this.fire("input",b)}}}},properties:{id:null,value:null,name:null,placeholder:null,readonly:!1,password:!1},methods:{focus:function(){this.input().dom().focus()},blur:function(){this.input().dom().blur()}},statics:{CSS:a.util.csssheet.create({".nx-normal-input":{position:"relative",overflow:"hidden"},".nx-normal-input > input":{position:"absolute",background:"transparent",left:"0",top:"0",width:"100%",height:"100%","line-height":"inherit",outline:"none",border:"0","border-radius":"inherit","text-indent":"inherit","font-family":"inherit","font-size":"inherit","font-weight":"inherit"}})}})}(nx),function(a){a.define("nx.lib.component.NormalSelect",a.ui.Element,{view:{cssclass:"nx-normal-select",content:{name:"select",type:"nx.ui.tag.Select",attributes:{id:"{id}",name:"{name}",readonly:a.binding("readonly")},content:{repeat:"{options}",type:"nx.ui.tag.SelectOption",attributes:{value:"{scope.model.value}",selected:a.binding("scope.context.value, scope.model.value",function(b,c){return(a.is(b,"Number")||a.is(b,"Boolean"))&&(b=""+b),b===c&&"selected"})},content:"{scope.model.text}"}}},properties:{id:null,name:null,value:null,options:null,readonly:!1},methods:{focus:function(){this.select().dom().focus()},blur:function(){this.select().dom().blur()}},statics:{CSS:a.util.csssheet.create({".nx-normal-select":{position:"relative",overflow:"hidden"},".nx-normal-select > select":{position:"absolute",background:"transparent",left:"0",top:"0",width:"100%",height:"100%",outline:"none",border:"0","border-radius":"inherit","text-indent":"inherit","font-family":"inherit","font-size":"inherit","font-weight":"inherit"}})}})}(nx),function(a,b,c,d,e){var f=10,g=a.define("nx.lib.component.CommonContenteditable",a.ui.Component,{events:["common_contenteditable_change","common_contenteditable_caret","common_contenteditable_keydown"],properties:{textHTML:{get:function(){return this.dom().innerHTML}},textPlain:{get:function(){return g.dom.plainate(this.dom()).text},set:function(a){a=a||"";for(var b;this.dom().firstChild;)this.dom().removeChild(this.dom().firstChild);b=document.createTextNode(a),this.dom().appendChild(b),this.notify("textPlain"),this._caret={node:b,text:a,offset:a?a.length:0},this.fire("common_contenteditable_change")}},caret:{get:function(){return this._caret||(this._caret={node:this.dom(),text:"",offset:0}),this._caret}},captureKeyCodeList:{value:[]}},view:{properties:{spellcheck:"false",tabindex:0,contenteditable:"true"},events:{input:"{#_handle_input}",keydown:"{#_handle_keydown}",keypress:"{#_handle_keypress}",focus:"{#_handle_focus_on}",blur:"{#_handle_focus_off}",mouseup:"{#_handle_mouseup}",click:"{#_handle_click}"}},methods:{empty:function(){this.inherited(arguments),this._caret=null,this.fire("common_contenteditable_change")},displace:function(a){var b,c,d,e,f=this.dom(),h=this._caret||{node:f,text:"",offset:0},i=a.value;h.node===f?h.offset==f.childNodes.length?"string"==typeof i?(c=document.createTextNode(i),f.appendChild(c),this.collapse(c,i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),f.appendChild(i),this.collapse(f,offset+1)):(d=f.childNodes[h.offset],"string"==typeof i?(c=document.createTextNode(i),f.insertBefore(c,d),this.collapse(c,i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),f.insertBefore(i,d),this.collapse(f,offset+1))):g.is.text(h.node)&&(e=a.deltaArea?a.deltaArea.slice():[0,0],e[0]+=h.offset,e[1]+=h.offset,"string"==typeof i?(b=h.text.substring(0,e[0])+i+h.text.substring(e[1]),h.node.textContent=b,this.collapse(h.node,e[0]+i.length)):g.is.element(i)&&(i.setAttribute("contenteditable","false"),b=h.text,e[0]>0?f.insertBefore(document.createTextNode(b.substring(0,e[0])),d):g.is.element(d.previousSibling)&&f.insertBefore(c=document.createTextNode(" "),d),f.insertBefore(i,d),e[1]<b.length?(c=document.createTextNode(b.substring(e[1])),f.insertBefore(c,d),f.removeChild(d),this.collapse(c,0)):(c=document.createTextNode(""),f.insertBefore(c,d),f.removeChild(d),this.collapse(c,0)))),g.dom.purify(this.dom()),this.fire("common_contenteditable_change")},detector:function(a){a?this._timer_detector||(this._timer_detector=setInterval(function(){this._lock_detector||this.updateCaret()}.bind(this),f)):this._timer_detector&&(clearInterval(this._timer_detector),this._timer_detector=!1)},collapse:function(a,b){window.getSelection().collapse(a,b),this.updateCaret()},updateCaret:function(){(function(){if("firefox"==a.Env.browser().name){var b=window.getSelection(),c=b.isCollapsed&&b.focusNode,d=b.isCollapsed&&b.focusOffset;g.is.text(c)&&c===this.dom().lastChild&&d==c.textContent.length&&(/\s$/.test(c.textContent)?window.getSelection().collapse(c,d-1):(c.textContent+=" ",window.getSelection().collapse(c,d)))}}).call(this);var b=window.getSelection().getRangeAt(0),c=b.startContainer,d=g.dom.plainate(c),e=this._caret&&this._caret.node,f=this._caret&&this._caret.text,h=this._caret&&this._caret.offset,i=this._caret&&this._caret.range;(e!==c||h!==d.offset||f!==d.text||i!==d.range)&&(this._caret={node:c,text:d.text,offset:d.offset,range:d.range},this.fire("common_contenteditable_caret",{node:c,text:d.text,offset:d.offset,range:d.range}))},_handle_input:function(){this._lock_detector=!0,setTimeout(function(){g.dom.purify(this.dom()),this.updateCaret(),this.fire("common_contenteditable_change"),this._lock_detector=!1}.bind(this),5)},_handle_focus_on:function(){this.detector(!0)},_handle_focus_off:function(){this.detector(!1)},_handle_keypress:function(a,b){b.stopPropagation()},_handle_keydown:function(a,b){var c,d=this.captureKeyCodeList();for(c=0;c<d.length;c++){if(b.which==d[c]){this.fire("common_contenteditable_keydown",b);break}if(13==b.which){b.preventDefault(),b.stopPropagation();break}}},_handle_mouseup:function(a,b){"A"==b.target.tagName&&b.target.parentNode===this.dom()&&window.getSelection().collapse(this.dom(),g.dom.index(b.target)+1)},_handle_click:function(a,b){"A"==b.target.tagName&&b.target.parentNode===this.dom()&&b.preventDefault()}},statics:{is:{contain:function(a,b){for(;b.parentNode&&b.parentNode!==b;){if(a===b.parendNode)return!0;b=b.parentNode}return!1},text:function(a){return!!a&&!a.tagName},element:function(a){return!!a&&!!a.tagName}},dom:{index:function(a){for(var b=0;a.previousSibling;)b++,a=a.previousSibling;return b},plainate:function(a){for(var b,c=window.getSelection(),d=c.rangeCount?c.getRangeAt(0):{},e=function(a){var b="",c=-1,f=-1;if(g.is.text(a))b=a.textContent,d.startContainer===a&&(c=d.startOffset,d.endContainer===a&&(f=d.endOffset-d.startOffset));else if(g.is.element(a)){var h,i,j,k=a.childNodes.length;for(h=0;k>h;h++)i=a.childNodes[h],j=e(i),c>=0?b+=j.text:(j.offset>=0&&(c=b.length+j.offset,f=j.range),b+=j.text);d.startContainer===a&&(c=b.length,f=0)}return{text:b,offset:c,range:f}},f=e(a);(b=f.text.indexOf(""))>=0;)b<f.offset&&f.offset--,f.text=f.text.substring(0,b)+f.text.substring(b+1);return f},purify:function(b){function c(a,b){var c=window.getSelection(),d=c.isCollapsed&&c.focusNode,e=c.isCollapsed&&c.focusOffset,f=d===a?e:d===b?a.textContent.length+e:-1;a.textContent=a.textContent+b.textContent,f>=0&&c.collapse(a,f)}var d,e,f,h,i;for(e=b.childNodes.length,d=e-1;d>=0;d--)if(f=b.childNodes[d],!g.is.text(f)){if(g.is.element(f)){if(h=g.dom.plainate(f),"A"==f.tagName.toUpperCase()&&f.getAttribute("href")&&"false"==f.getAttribute("contenteditable"))continue;h.text&&(i=document.createTextNode(h.text),b.insertBefore(i,f),h.offset>=0&&window.getSelection().collapse(i,h.offset))}b.removeChild(f)}for(e=b.childNodes.length,d=e-1;d>=0;d--)f=b.childNodes[d],g.is.text(f)&&(h=g.dom.plainate(f),h.text?(f.textContent!==h.text&&(f.textContent=h.text),h.offset>=0&&window.getSelection().collapse(f,h.offset),g.is.text(f.nextSibling)&&(c(f,f.nextSibling),b.removeChild(f.nextSibling))):(b.removeChild(f),h.offset>=0&&window.getSelection().collapse(b,d)));if("chrome"==a.Env.browser().name){var j=window.getSelection(),k=j.isCollapsed&&j.focusNode,l=j.isCollapsed&&j.focusOffset;k===b&&g.is.element(b.lastChild)&&l==b.childNodes.length&&(f=document.createTextNode(""),b.appendChild(f),window.getSelection().collapse(b,l))}else"firefox"==a.Env.browser().name&&(f=document.createTextNode(""),b.appendChild(f))}}}})}(nx,nx.position,nx.dom,nx.ui,window),function(a,b,c,d,e){var f=a.define("nx.lib.component.AutoComplete",a.ui.Element,{view:{attributes:{"class":"position-parent"},content:[{name:"input",type:"nx.lib.component.CommonContenteditable",attributes:{"class":"input form-control",tabindex:a.binding("tabindex"),contenteditable:a.binding("contenteditable")},events:{common_contenteditable_caret:"_handle_input_caret",common_contenteditable_keydown:"_handle_input_keydown",common_contenteditable_change:"_handle_input_change"}},{name:"list",attributes:{tabindex:0,"class":["list",a.binding("listVisibilityClass_internal_")],style:{position:"absolute"}},content:a.binding("listItemTemplate",function(b){return b?a.template({source:"listData",pattern:b}):void 0})}]},properties:{value:{get:function(){return this.input().textPlain()},set:function(a){this.input().textPlain(a),this.notify("value")}},contenteditable:{value:!0},tabindex:{value:-1},promptMode:{value:"input"},inputCaret_internal_:{value:null},inputCaretReplaceInfo_internal_:{value:a.binding({context:!0,source:"promptMode, inputCaret_internal_",callback:function(a,b){if(!b||b.offset<0||"string"!=typeof b.text)return null;var c=b.text,d=b.offset,e=b.range;(0>e||e+d>c.length)&&(e=c.length-d);var f,g=null,h=c.substring(0,d),i=(c.substring(d,d+e),c.substring(d+e));switch(a){case"select":g={keyword:h,deltaStart:-h.length,deltaEnd:c.length-h.length};break;case"caret":case"input":default:(!i||/^\s/.test(i))&&/^(.*\s)?([^\s]+)$/.test(h)&&(f=h.replace(/^(.*\s)?([^\s]*)$/,"$2"),g={keyword:f,deltaStart:-f.length,deltaEnd:e})}return g}})},inputFocus:{value:!1},inputCaptureKeyCodeList_internal_:{value:[],value:a.binding({context:!0,source:"listVisibility_internal_",callback:function(a){return a?f.captureKeyCodeList:[]}}),watcher:function(){this.input().captureKeyCodeList(this.inputCaptureKeyCodeList_internal_())}},listData:{value:[],watcher:function(){var a=this.list();setTimeout(function(){nxex.toolkit.collectionItemHandle(a.content(),function(a,b){b.dom().addClass("item");var c,d,e;return c=function(){this.listItemActivated(b)}.bind(this),d=function(){this.listItemActivated(null)}.bind(this),e=function(){this._executeSelection(b.template().model())}.bind(this),b.on("mouseenter",c),b.on("mouseleave",d),b.on("click",e),{release:function(){b.off("mouseenter",c),b.off("mouseleave",d),b.off("click",e)}}}.bind(this)).notify()}.bind(this),1)}},listDataKeyPath:{value:""},listDataFilter:{value:null},listDataSelector_internal_:{value:null,value:a.binding({context:!0,source:"listDataKeyPath,listDataFilter",callback:function(a,b){return b?b:f.selectorByPath(a)}})},listItemCountLimit:{value:0},listDataSelected_internal_:{value:[],value:a.binding({context:!0,source:"inputCaretReplaceInfo_internal_,listData,listDataSelector_internal_,listItemCountLimit",callback:function(a,b,c,d){if(!c)return[];var e=c.call(this,a,b);return e&&e.length>0&&d>0&&(e=e.slice(0,d)),e}}),watcher:function(){var b=this.list(),c=this.listDataSelected_internal_();c&&c.length&&a.each(b.content(),function(a){var b;for(b=0;b<c.length&&a.template().model()!==c[b];b++);a.dom().setClass("hidden",b>=c.length)}.bind(this))}},listItemActivated:{value:-1,get:function(){var a,b,c=this.list().content().toArray();for(a=0;a<c.length;a++)if(b=c[a],b.dom().hasClass("active"))return b;return null},set:function(a){var b,c,d=this.list().content().toArray();for(b=0;b<d.length;b++)c=d[b],a!==c||c.dom().hasClass("hidden")?c.dom().removeClass("active"):c.dom().addClass("active")},value:a.binding({context:!0,source:"listDataSelected_internal_",callback:function(a){var b=this.listItemActivated();return b&&b.dom().hasClass("hidden")?b:null}}),watcher:function(a,b){b&&this._scrollTo(b)}},listVisibility_internal_:{value:!0,value:a.binding({context:!0,source:"inputFocus,listDataSelected_internal_",callback:function(a,b){return b&&b.length&&a?!0:!1}}),watcher:function(){var a=this.promptMode();f.adjustListPosition(a,this,this.list())}},listVisibilityClass_internal_:{value:a.binding("listVisibility_internal_",function(a){return a?"":"hidden"})},listItemTemplate:{value:{content:a.binding("model")}},listDataSelectedItem:{value:null,value:a.binding({context:!0,source:"promptMode, listData, inputCaretReplaceInfo_internal_, listDataKeyPath",callback:function(b,c,d,e){var f=this.listDataSelectedItem(),g=this.value();if(c&&d)switch(b){case"select":var h,i,j,k=[];for(h=0;c&&h<c.length;h++)i=c[h],j=a.path(i,e),(j||"").toLowerCase()===(g||"").toLowerCase()&&k.push(i);f=1==k.length?k[0]:null}return f}}),watcher:function(){this.fire("execute_selection",this.listDataSelectedItem())}}},methods:{init:function(){this.inherited(),this.focusGroup=new nxex.common.FocusGroup,this.focusGroup.add(this.input()),this.focusGroup.add(this.list()),this.focusGroup.on("focus",this._handle_group_focus,this),this.focusGroup.on("blur",this._handle_group_blur,this)},clear:function(){this.input().empty(),this.fire("execute_change")},_scrollTo:function(a){var b=(this._getListItemIndex(a),this.list()),c=a.dom(),d=b.dom(),e=a.dom().getBound(),f=b.dom().getBound(),g=c.offsetHeight,h=e.top,i=d.clientHeight,j=f.top;d.scrollTop;h+g>j+i&&(d.scrollTop+=h+g-(j+i)),j>h&&(d.scrollTop-=j-h)},_executeSelection:function(b){var c=this.inputCaretReplaceInfo_internal_();if(c){var d=this.listDataKeyPath(),e=a.path(b,d);this.input().displace({deltaArea:[c.deltaStart,c.deltaEnd],value:e}),this.listDataSelectedItem(b)}},_getListItemIndex:function(a){var b,c,d=this.list().content().toArray();for(b=0;b<d.length;b++)if(c=d[b],c===a)return b;return-1},_getListItemRelative:function(a,b){var c,d=null,e=this.list().content().toArray();switch(b){case"previous-visible":for(c=this._getListItemIndex(a);--c>=0;)if(!e[c].dom().hasClass("hidden")){d=e[c];break}break;case"next-visible":for(c=this._getListItemIndex(a);++c<e.length;)if(!e[c].dom().hasClass("hidden")){d=e[c];break}break;case"first":case"last":case"first-visible":case"last-visible":case"previous":case"next":}return d},_handle_focus:function(){this.input().dom().focus()},_handle_group_focus:function(){this.inputFocus(!0),this.fire("focus")},_handle_group_blur:function(){this.inputFocus(!1),this.fire("blur")},_handle_input_caret:function(){this.inputCaret_internal_(this.input().caret())},_handle_input_change:function(){this.inputCaret_internal_(this.input().caret()),this.fire("execute_change")},_handle_input_keydown:function(a,b){var c;switch(b.which){case 13:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c||(c=this._getListItemRelative(c,"next-visible")),c&&c.model()&&this._executeSelection(c.model()));break;case 38:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c=this._getListItemRelative(c,"previous-visible"),c&&this.listItemActivated(c));break;case 40:this.listVisibility_internal_()&&(b.preventDefault(),c=this.listItemActivated(),c=this._getListItemRelative(c,"next-visible"),c&&this.listItemActivated(c))}}},statics:{captureKeyCodeList:[13,38,40],caretRect:function(){var a,b=window.getSelection();return b.rangeCount&&(a=b.getRangeAt(0).getClientRects()[0]),a&&(a={left:a.left,top:a.top,width:a.width,height:a.height}),a},adjustListPosition:function(a,b,c){var d=b.dom().offsetParent;if(d){var e,g=d.getBoundingClientRect(),h=d.scrollLeft,i=d.scrollTop;switch(a){case"caret":var e=f.caretRect();e.top+=i-g.top,e.left+=h-g.left,c.dom().setStyle("left",e.left),c.dom().setStyle("top",e.top+e.height);break;case"input":case"select":default:var e=b.dom().getBound();e.top+=i-g.top,e.left+=h-g.left,c.dom().setStyle("left",e.left),c.dom().setStyle("top",e.top+e.height),c.dom().setStyle("width",e.width)}}},selectorByPath:function(b){function c(c){var d,e,f=[];for(d=0;d<c.length;d++)e=c[d],f.push(a.path(e,b));return f}function d(a,b){return b&&0==b.toLowerCase().replace(/\s/g,"").indexOf(a.toLowerCase().replace(/\s/g,""))&&b.length>a.length}return function(a,b){var e,f,g=[];if(a)for(f=c(b),keyword=a.keyword,e=0;e<b.length;e++)d(keyword,f[e])&&g.push(b[e]);return g}}}})}(nx,nx.position,nx.dom,nx.ui,window),function(a){a.define("nx.lib.component.CentralizedImage",a.ui.Element,{view:{attributes:{"class":["nx-centralized-image"]},content:{name:"image",type:"nx.ui.tag.Image",attributes:{src:a.binding("src")},events:{load:function(){var a=this.image(),b=a.dom();this.clip()?(a.toggleClass("size-height",b.height>b.width),a.toggleClass("size-width",b.width>=b.height)):(a.toggleClass("size-height",b.height<b.width),a.toggleClass("size-width",b.width<=b.height)),this.fire("ready")}}}},properties:{src:{},clip:!0},statics:{CSS:a.util.csssheet.create({".nx-centralized-image":{position:"relative",overflow:"hidden"},".nx-centralized-image > img":{position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",margin:"auto"},".nx-centralized-image > img.size-height":{width:"100%"},".nx-centralized-image > img.size-width":{height:"100%"}})}})}(nx),function(a){var b=(a.geometry.Matrix,a.util.cssstyle),c=a.define("nx.lib.component.SvgIcon",a.ui.Element,{view:{cssclass:"nx-comp svg-icon",content:{type:"nx.ui.tag.Image",attributes:{src:"{imgsrc}"}}},properties:{src:"",bgsrc:"",key:"",resize:null,fill:null,svg:{dependencies:"src",async:!0,value:function(a,b){this.release("svg"),b&&this.retain("svg",c.loadSvg(b,function(b){a.set(b)}))}},bgsvg:{dependencies:"bgsrc",async:!0,value:function(a,b){this.release("bgsvg"),b&&this.retain("bgsvg",c.loadSvg(b,function(b){a.set(b)}))}},imgsrc:{dependencies:"svg,bgsvg,key,resize,fill",value:function(d,e,f,g,h){if(!d)return"//:0";if(f){var i=d.querySelector("#"+f);if(!i)return"//:0";var j,k,l,m,n;return k=c.getSvgSize(d),e?(e=e.cloneNode(!0),g=c.getSvgSize(e)):(e=document.createElementNS("http://www.w3.org/2000/svg","svg"),g?(e.setAttribute("width",g.width+"px"),e.setAttribute("height",g.height+"px")):(e.setAttribute("width",k.width+"px"),e.setAttribute("height",k.height+"px"))),i=i.cloneNode(!0),i.removeAttribute("id"),c.cleanStyle(i),g&&g.width&&g.height&&(l=k.width,m=k.height,l&&m&&(scale=Math.min(g.width/l,g.height/m),n=Array([scale,0,0],[0,scale,0],[0,0,1]),j=document.createElementNS("http://www.w3.org/2000/svg","g"),j.appendChild(i),i=j,b.set(i,"transform",a.util.cssstyle.toCssTransformMatrix(n)))),b.set(i,"fill",h),e.appendChild(i),a.lib.svg.Svg.serialize(e)}return a.lib.svg.Svg.serialize(e||d)||"//:0"}}},statics:{cleanStyle:function(a){if(a instanceof Element){a.removeAttribute("class"),a.removeAttribute("style");var b,d=a.childNodes.length;for(b=0;d>b;b++)c.cleanStyle(a.childNodes[b])}},loadSvg:function(b,c){return a.util.ajax({url:b,success:function(a,b){if("string"==typeof b){var d=document.createElement("div");d.innerHTML=b,b=d.querySelector("svg")}else b.tagName&&"svg"===b.tagName.toLowerCase()||(b=b.querySelector("svg"));c(b)}})},getSvgSize:function(a){var b=a.getAttribute("width"),c=a.getAttribute("height"),d=a.getAttribute("viewBox");return b&&(b=1*b.replace(/[^-.0123456789]/g,"")),c&&(c=1*c.replace(/[^-.0123456789]/g,"")),d&&(d=d.split(" "),b=b||1*d[2]||0,c=b||1*d[3]||0),{width:b||0,height:c||0}},CSS:a.util.csssheet.create({".nx-comp.svg-icon":{position:"relative"},".nx-comp.svg-icon > img":{width:"100%",height:"100%",outline:"none",border:"0"},".nx-comp.svg-icon:after":{content:" ",position:"absolute",background:"transparent",left:"0",top:"0",width:"100%",height:"100%"}})}})}(nx);